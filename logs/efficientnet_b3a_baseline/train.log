Reading data...
train shape:
(28217, 2)
valid shape:
(3529, 2)
train fold:
label
0    10295
1     7526
2     3557
3     3530
4     2463
5      191
6      655
dtype: int64
validation fold:
label
0    1329
1     899
2     458
3     415
4     325
5      32
6      71
dtype: int64
Batch size 32
Input size 48
Select CrossEntropyLoss criterion
Enabling mixed precision for training...
Current learning rate: 0.001
Epoch 1 - avg_train_loss: 1.0660             avg_val_loss: 0.7647  time: 70s
Epoch 1 - Accuracy: 0.7308019268914707 - F1-score 0.7196529695467764
Epoch 1 - Save Best Accuracy: 0.7308 -                 Save Best F1-score: 0.7197 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 2 - avg_train_loss: 0.7144             avg_val_loss: 0.6497  time: 70s
Epoch 2 - Accuracy: 0.7716066874468688 - F1-score 0.7663107775004986
Epoch 2 - Save Best Accuracy: 0.7716 -                 Save Best F1-score: 0.7663 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 3 - avg_train_loss: 0.5774             avg_val_loss: 0.6948  time: 69s
Epoch 3 - Accuracy: 0.7483706432417115 - F1-score 0.7527557195589517
Number of bad epochs 1
Current learning rate: 0.001
Epoch 4 - avg_train_loss: 0.4911             avg_val_loss: 0.6412  time: 68s
Epoch 4 - Accuracy: 0.7764239161235478 - F1-score 0.7737482437016149
Epoch 4 - Save Best Accuracy: 0.7764 -                 Save Best F1-score: 0.7737 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 5 - avg_train_loss: 0.4207             avg_val_loss: 0.6424  time: 69s
Epoch 5 - Accuracy: 0.7846415415131766 - F1-score 0.7835387397833158
Epoch 5 - Save Best Accuracy: 0.7846 -                 Save Best F1-score: 0.7835 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 6 - avg_train_loss: 0.3491             avg_val_loss: 0.6553  time: 69s
Epoch 6 - Accuracy: 0.788608671011618 - F1-score 0.7862882456718256
Epoch 6 - Save Best Accuracy: 0.7886 -                 Save Best F1-score: 0.7863 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 7 - avg_train_loss: 0.2938             avg_val_loss: 0.6907  time: 69s
Epoch 7 - Accuracy: 0.7891754037971097 - F1-score 0.785464481344548
Number of bad epochs 1
Current learning rate: 0.001
Epoch 8 - avg_train_loss: 0.2565             avg_val_loss: 0.7130  time: 69s
Epoch 8 - Accuracy: 0.7809577784074808 - F1-score 0.7792118733664525
Number of bad epochs 2
Current learning rate: 0.001
Epoch 9 - avg_train_loss: 0.2238             avg_val_loss: 0.7528  time: 68s
Epoch 9 - Accuracy: 0.7687730235194106 - F1-score 0.7723919125751932
Number of bad epochs 3
Current learning rate: 0.001
Epoch 10 - avg_train_loss: 0.1956             avg_val_loss: 0.8196  time: 69s
Epoch 10 - Accuracy: 0.7713233210541229 - F1-score 0.7696757938560098
Number of bad epochs 4
Current learning rate: 0.001
Epoch 11 - avg_train_loss: 0.1746             avg_val_loss: 0.8099  time: 70s
Epoch 11 - Accuracy: 0.7869084726551431 - F1-score 0.7853348242738446
Number of bad epochs 5
Current learning rate: 0.001
Epoch 12 - avg_train_loss: 0.1642             avg_val_loss: 0.8605  time: 69s
Epoch 12 - Accuracy: 0.7823746103712099 - F1-score 0.7801837669526387
Number of bad epochs 6
Current learning rate: 0.001
Epoch 13 - avg_train_loss: 0.1454             avg_val_loss: 0.8671  time: 69s
Epoch 13 - Accuracy: 0.766506092377444 - F1-score 0.7702702012630486
Number of bad epochs 7
Current learning rate: 0.001
Epoch 14 - avg_train_loss: 0.1417             avg_val_loss: 0.7410  time: 70s
Epoch 14 - Accuracy: 0.7832247095494475 - F1-score 0.7832540154415529
Number of bad epochs 8
Current learning rate: 0.001
Epoch 15 - avg_train_loss: 0.1289             avg_val_loss: 0.8531  time: 69s
Epoch 15 - Accuracy: 0.7835080759421933 - F1-score 0.7830419734038997
Number of bad epochs 9
Current learning rate: 0.001
Epoch 16 - avg_train_loss: 0.1274             avg_val_loss: 0.8912  time: 69s
Epoch 16 - Accuracy: 0.7741569849815811 - F1-score 0.7748215504729284
Number of bad epochs 10
Current learning rate: 0.001
Epoch 17 - avg_train_loss: 0.1146             avg_val_loss: 0.8562  time: 69s
Epoch 17 - Accuracy: 0.7900255029753471 - F1-score 0.7877892275253542
Epoch 17 - Save Best Accuracy: 0.7900 -                 Save Best F1-score: 0.7878 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 18 - avg_train_loss: 0.1123             avg_val_loss: 1.0432  time: 69s
Epoch 18 - Accuracy: 0.7829413431567016 - F1-score 0.7756490002960427
Number of bad epochs 1
Current learning rate: 0.001
Epoch 19 - avg_train_loss: 0.1068             avg_val_loss: 0.9336  time: 70s
Epoch 19 - Accuracy: 0.7849249079059224 - F1-score 0.7810732201192793
Number of bad epochs 2
Current learning rate: 0.001
Epoch 20 - avg_train_loss: 0.0988             avg_val_loss: 0.9650  time: 70s
Epoch 20 - Accuracy: 0.7642391612354775 - F1-score 0.7685717760332311
Number of bad epochs 3
Current learning rate: 0.001
Epoch 21 - avg_train_loss: 0.0925             avg_val_loss: 1.0752  time: 70s
Epoch 21 - Accuracy: 0.7840748087276849 - F1-score 0.7842112183990813
Number of bad epochs 4
Current learning rate: 0.001
Epoch 22 - avg_train_loss: 0.1000             avg_val_loss: 0.9481  time: 70s
Epoch 22 - Accuracy: 0.7718900538396146 - F1-score 0.7726982234582496
Number of bad epochs 5
Current learning rate: 0.001
Epoch 23 - avg_train_loss: 0.0922             avg_val_loss: 1.0788  time: 71s
Epoch 23 - Accuracy: 0.7843581751204307 - F1-score 0.7808399964849336
Number of bad epochs 6
Current learning rate: 0.001
Epoch 24 - avg_train_loss: 0.0880             avg_val_loss: 0.9299  time: 69s
Epoch 24 - Accuracy: 0.7832247095494475 - F1-score 0.7824010649922147
Number of bad epochs 7
Current learning rate: 0.001
Epoch 25 - avg_train_loss: 0.0830             avg_val_loss: 1.0134  time: 70s
Epoch 25 - Accuracy: 0.7874752054406348 - F1-score 0.7841916022127978
Number of bad epochs 8
Current learning rate: 0.001
Epoch 26 - avg_train_loss: 0.0820             avg_val_loss: 0.9714  time: 69s
Epoch 26 - Accuracy: 0.7863417398696515 - F1-score 0.7837687760050588
Number of bad epochs 9
Current learning rate: 0.001
Epoch 27 - avg_train_loss: 0.0852             avg_val_loss: 1.0887  time: 68s
Epoch 27 - Accuracy: 0.7767072825162936 - F1-score 0.7779056968698089
Number of bad epochs 10
Current learning rate: 0.001
Epoch 28 - avg_train_loss: 0.0838             avg_val_loss: 1.0142  time: 67s
Epoch 28 - Accuracy: 0.7832247095494475 - F1-score 0.7834295366616012
Number of bad epochs 11
Stop the training, since the score has not improved for 10 epochs!
AFTER TRAINING: Epoch 17: Best Accuracy: 0.7900 -                 Best F1-score: 0.7878
