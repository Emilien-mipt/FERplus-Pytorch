Reading data...
train shape:
(28217, 2)
valid shape:
(3529, 2)
train fold:
label
0    10295
1     7526
2     3557
3     3530
4     2463
5      191
6      655
dtype: int64
validation fold:
label
0    1329
1     899
2     458
3     415
4     325
5      32
6      71
dtype: int64
Batch size 32
Input size 224
Select CrossEntropyLoss criterion
Enabling mixed precision for training...
Current learning rate: 0.015
Epoch 1 - avg_train_loss: 0.8506             avg_val_loss: 0.5963  time: 77s
Epoch 1 - Accuracy: 0.7891754037971097 - F1-score 0.7807169076384721
Epoch 1 - Save Best Accuracy: 0.7892 -                 Save Best F1-score: 0.7807 Model
Number of bad epochs 0
Current learning rate: 0.02
Epoch 2 - avg_train_loss: 0.5833             avg_val_loss: 0.5329  time: 77s
Epoch 2 - Accuracy: 0.8024936242561632 - F1-score 0.7984087712345604
Epoch 2 - Save Best Accuracy: 0.8025 -                 Save Best F1-score: 0.7984 Model
Number of bad epochs 0
Current learning rate: 0.015
Epoch 3 - avg_train_loss: 0.4972             avg_val_loss: 0.4806  time: 77s
Epoch 3 - Accuracy: 0.820062340606404 - F1-score 0.8121830060874435
Epoch 3 - Save Best Accuracy: 0.8201 -                 Save Best F1-score: 0.8122 Model
Number of bad epochs 0
Current learning rate: 0.01
Epoch 4 - avg_train_loss: 0.4420             avg_val_loss: 0.4793  time: 77s
Epoch 4 - Accuracy: 0.8262964012468121 - F1-score 0.8190164598077709
Epoch 4 - Save Best Accuracy: 0.8263 -                 Save Best F1-score: 0.8190 Model
Number of bad epochs 0
Current learning rate: 0.0125
Epoch 5 - avg_train_loss: 0.4090             avg_val_loss: 0.5094  time: 77s
Epoch 5 - Accuracy: 0.8047605553981297 - F1-score 0.800308329966871
Number of bad epochs 1
Current learning rate: 0.015
Epoch 6 - avg_train_loss: 0.3704             avg_val_loss: 0.4392  time: 77s
Epoch 6 - Accuracy: 0.8384811561348824 - F1-score 0.8373016736163862
Epoch 6 - Save Best Accuracy: 0.8385 -                 Save Best F1-score: 0.8373 Model
Number of bad epochs 0
Current learning rate: 0.0125
Epoch 7 - avg_train_loss: 0.3407             avg_val_loss: 0.4471  time: 77s
Epoch 7 - Accuracy: 0.8364975913856617 - F1-score 0.8358412416220873
Number of bad epochs 1
Current learning rate: 0.01
Epoch 8 - avg_train_loss: 0.3252             avg_val_loss: 0.4787  time: 77s
Epoch 8 - Accuracy: 0.8237461037120998 - F1-score 0.8227355729619146
Number of bad epochs 2
Current learning rate: 0.01125
Epoch 9 - avg_train_loss: 0.2962             avg_val_loss: 0.4428  time: 77s
Epoch 9 - Accuracy: 0.8370643241711533 - F1-score 0.8361635070636121
Number of bad epochs 3
Current learning rate: 0.0125
Epoch 10 - avg_train_loss: 0.2800             avg_val_loss: 0.4690  time: 77s
Epoch 10 - Accuracy: 0.8330971946727118 - F1-score 0.8323438686611736
Number of bad epochs 4
Current learning rate: 0.01125
Epoch 11 - avg_train_loss: 0.2593             avg_val_loss: 0.4924  time: 77s
Epoch 11 - Accuracy: 0.8291300651742703 - F1-score 0.8262306231724876
Number of bad epochs 5
Current learning rate: 0.01
Epoch 12 - avg_train_loss: 0.2437             avg_val_loss: 0.5025  time: 77s
Epoch 12 - Accuracy: 0.83593085860017 - F1-score 0.8366419441503564
Number of bad epochs 6
Current learning rate: 0.010625
Epoch 13 - avg_train_loss: 0.2359             avg_val_loss: 0.5059  time: 77s
Epoch 13 - Accuracy: 0.8384811561348824 - F1-score 0.8344042614328909
Number of bad epochs 7
Current learning rate: 0.01125
Epoch 14 - avg_train_loss: 0.2201             avg_val_loss: 0.5054  time: 77s
Epoch 14 - Accuracy: 0.8424482856333239 - F1-score 0.842313757652611
Epoch 14 - Save Best Accuracy: 0.8424 -                 Save Best F1-score: 0.8423 Model
Number of bad epochs 0
Current learning rate: 0.010625
Epoch 15 - avg_train_loss: 0.2057             avg_val_loss: 0.5181  time: 77s
Epoch 15 - Accuracy: 0.8342306602436951 - F1-score 0.8327700865646142
Number of bad epochs 1
Current learning rate: 0.01
Epoch 16 - avg_train_loss: 0.1967             avg_val_loss: 0.5413  time: 77s
Epoch 16 - Accuracy: 0.8288466987815245 - F1-score 0.8299395967114307
Number of bad epochs 2
Current learning rate: 0.0103125
Epoch 17 - avg_train_loss: 0.1902             avg_val_loss: 0.5422  time: 77s
Epoch 17 - Accuracy: 0.8350807594219326 - F1-score 0.8320523038529904
Number of bad epochs 3
Current learning rate: 0.010625
Epoch 18 - avg_train_loss: 0.1798             avg_val_loss: 0.5280  time: 78s
Epoch 18 - Accuracy: 0.8396146217058656 - F1-score 0.8397667358573818
Number of bad epochs 4
Current learning rate: 0.0103125
Epoch 19 - avg_train_loss: 0.1692             avg_val_loss: 0.5788  time: 77s
Epoch 19 - Accuracy: 0.8333805610654577 - F1-score 0.8318021111656565
Number of bad epochs 5
Current learning rate: 0.01
Epoch 20 - avg_train_loss: 0.1705             avg_val_loss: 0.5758  time: 77s
Epoch 20 - Accuracy: 0.831113629923491 - F1-score 0.8323988861089241
Number of bad epochs 6
Current learning rate: 0.01015625
Epoch 21 - avg_train_loss: 0.1585             avg_val_loss: 0.5620  time: 77s
Epoch 21 - Accuracy: 0.842164919240578 - F1-score 0.8402101407560266
Number of bad epochs 7
Current learning rate: 0.0103125
Epoch 22 - avg_train_loss: 0.1541             avg_val_loss: 0.6148  time: 77s
Epoch 22 - Accuracy: 0.8330971946727118 - F1-score 0.8324544870962068
Number of bad epochs 8
Current learning rate: 0.01015625
Epoch 23 - avg_train_loss: 0.1491             avg_val_loss: 0.5463  time: 77s
Epoch 23 - Accuracy: 0.842164919240578 - F1-score 0.841451759315249
Number of bad epochs 9
Current learning rate: 0.01
Epoch 24 - avg_train_loss: 0.1356             avg_val_loss: 0.5972  time: 78s
Epoch 24 - Accuracy: 0.8342306602436951 - F1-score 0.8334041999388282
Number of bad epochs 10
Current learning rate: 0.010078125
Epoch 25 - avg_train_loss: 0.1429             avg_val_loss: 0.5861  time: 77s
Epoch 25 - Accuracy: 0.8413148200623406 - F1-score 0.8411117436257278
Number of bad epochs 11
Stop the training, since the score has not improved for 10 epochs!
AFTER TRAINING: Epoch 14: Best Accuracy: 0.8424 -                 Best F1-score: 0.8423
