Reading data...
train shape:
(28217, 2)
valid shape:
(3529, 2)
train fold:
label
0    10295
1     7526
2     3557
3     3530
4     2463
5      191
6      655
dtype: int64
validation fold:
label
0    1329
1     899
2     458
3     415
4     325
5      32
6      71
dtype: int64
Batch size 16
Input size 224
Select CrossEntropyLoss criterion
Enabling mixed precision for training...
Current learning rate: 0.001
Epoch 1 - avg_train_loss: 0.9389             avg_val_loss: 0.7302  time: 102s
Epoch 1 - Accuracy: 0.7432700481722868 - F1-score 0.7302506901879696
Epoch 1 - Save Best Accuracy: 0.7433 -                 Save Best F1-score: 0.7303 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 2 - avg_train_loss: 0.7105             avg_val_loss: 0.6513  time: 102s
Epoch 2 - Accuracy: 0.7557381694531029 - F1-score 0.7511363379371436
Epoch 2 - Save Best Accuracy: 0.7557 -                 Save Best F1-score: 0.7511 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 3 - avg_train_loss: 0.6231             avg_val_loss: 0.5670  time: 102s
Epoch 3 - Accuracy: 0.790308869368093 - F1-score 0.7857063045145087
Epoch 3 - Save Best Accuracy: 0.7903 -                 Save Best F1-score: 0.7857 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 4 - avg_train_loss: 0.5650             avg_val_loss: 0.5618  time: 101s
Epoch 4 - Accuracy: 0.7911589685463304 - F1-score 0.7869181858533041
Epoch 4 - Save Best Accuracy: 0.7912 -                 Save Best F1-score: 0.7869 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 5 - avg_train_loss: 0.5240             avg_val_loss: 0.5319  time: 102s
Epoch 5 - Accuracy: 0.8019268914706715 - F1-score 0.7993826384909718
Epoch 5 - Save Best Accuracy: 0.8019 -                 Save Best F1-score: 0.7994 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 6 - avg_train_loss: 0.4807             avg_val_loss: 0.4875  time: 102s
Epoch 6 - Accuracy: 0.820062340606404 - F1-score 0.8170366445734988
Epoch 6 - Save Best Accuracy: 0.8201 -                 Save Best F1-score: 0.8170 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 7 - avg_train_loss: 0.4483             avg_val_loss: 0.4741  time: 102s
Epoch 7 - Accuracy: 0.8220459053556248 - F1-score 0.8198168181860963
Epoch 7 - Save Best Accuracy: 0.8220 -                 Save Best F1-score: 0.8198 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 8 - avg_train_loss: 0.4207             avg_val_loss: 0.4921  time: 102s
Epoch 8 - Accuracy: 0.8214791725701331 - F1-score 0.8174613877425135
Number of bad epochs 1
Current learning rate: 0.001
Epoch 9 - avg_train_loss: 0.3933             avg_val_loss: 0.4911  time: 101s
Epoch 9 - Accuracy: 0.8146783791442335 - F1-score 0.8131556516096045
Number of bad epochs 2
Current learning rate: 0.001
Epoch 10 - avg_train_loss: 0.3658             avg_val_loss: 0.4831  time: 102s
Epoch 10 - Accuracy: 0.8183621422499292 - F1-score 0.8185254022378778
Number of bad epochs 3
Current learning rate: 0.001
Epoch 11 - avg_train_loss: 0.3464             avg_val_loss: 0.4594  time: 102s
Epoch 11 - Accuracy: 0.8339472938509492 - F1-score 0.8319229726167685
Epoch 11 - Save Best Accuracy: 0.8339 -                 Save Best F1-score: 0.8319 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 12 - avg_train_loss: 0.3178             avg_val_loss: 0.5000  time: 102s
Epoch 12 - Accuracy: 0.826579767639558 - F1-score 0.8266880210626801
Number of bad epochs 1
Current learning rate: 0.001
Epoch 13 - avg_train_loss: 0.3015             avg_val_loss: 0.5018  time: 102s
Epoch 13 - Accuracy: 0.8214791725701331 - F1-score 0.8201509609810725
Number of bad epochs 2
Current learning rate: 0.001
Epoch 14 - avg_train_loss: 0.2798             avg_val_loss: 0.4730  time: 101s
Epoch 14 - Accuracy: 0.8356474922074242 - F1-score 0.8345797042336024
Epoch 14 - Save Best Accuracy: 0.8356 -                 Save Best F1-score: 0.8346 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 15 - avg_train_loss: 0.2692             avg_val_loss: 0.4834  time: 102s
Epoch 15 - Accuracy: 0.8350807594219326 - F1-score 0.8326890249366233
Number of bad epochs 1
Current learning rate: 0.001
Epoch 16 - avg_train_loss: 0.2509             avg_val_loss: 0.5069  time: 101s
Epoch 16 - Accuracy: 0.8274298668177954 - F1-score 0.8264424144220315
Number of bad epochs 2
Current learning rate: 0.001
Epoch 17 - avg_train_loss: 0.2307             avg_val_loss: 0.5088  time: 102s
Epoch 17 - Accuracy: 0.8316803627089827 - F1-score 0.8301636162847598
Number of bad epochs 3
Current learning rate: 0.001
Epoch 18 - avg_train_loss: 0.2257             avg_val_loss: 0.5639  time: 102s
Epoch 18 - Accuracy: 0.8211958061773874 - F1-score 0.8213713742760803
Number of bad epochs 4
Current learning rate: 0.001
Epoch 19 - avg_train_loss: 0.2119             avg_val_loss: 0.5038  time: 102s
Epoch 19 - Accuracy: 0.8353641258146783 - F1-score 0.8336052405957628
Number of bad epochs 5
Current learning rate: 0.001
Epoch 20 - avg_train_loss: 0.2046             avg_val_loss: 0.5379  time: 102s
Epoch 20 - Accuracy: 0.8342306602436951 - F1-score 0.8341426082296254
Number of bad epochs 6
Current learning rate: 0.001
Epoch 21 - avg_train_loss: 0.1930             avg_val_loss: 0.5328  time: 102s
Epoch 21 - Accuracy: 0.8393312553131199 - F1-score 0.8361130263450658
Epoch 21 - Save Best Accuracy: 0.8393 -                 Save Best F1-score: 0.8361 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 22 - avg_train_loss: 0.1882             avg_val_loss: 0.5502  time: 102s
Epoch 22 - Accuracy: 0.8322470954944744 - F1-score 0.8315967922161183
Number of bad epochs 1
Current learning rate: 0.001
Epoch 23 - avg_train_loss: 0.1793             avg_val_loss: 0.5538  time: 102s
Epoch 23 - Accuracy: 0.824879569283083 - F1-score 0.8250993845608031
Number of bad epochs 2
Current learning rate: 0.001
Epoch 24 - avg_train_loss: 0.1726             avg_val_loss: 0.5723  time: 102s
Epoch 24 - Accuracy: 0.8398979880986115 - F1-score 0.8377369510759595
Epoch 24 - Save Best Accuracy: 0.8399 -                 Save Best F1-score: 0.8377 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 25 - avg_train_loss: 0.1646             avg_val_loss: 0.6194  time: 102s
Epoch 25 - Accuracy: 0.8330971946727118 - F1-score 0.8294434293733945
Number of bad epochs 1
Current learning rate: 0.001
Epoch 26 - avg_train_loss: 0.1594             avg_val_loss: 0.5693  time: 102s
Epoch 26 - Accuracy: 0.8279965996032871 - F1-score 0.8283980377592418
Number of bad epochs 2
Current learning rate: 0.001
Epoch 27 - avg_train_loss: 0.1530             avg_val_loss: 0.5928  time: 101s
Epoch 27 - Accuracy: 0.8347973930291868 - F1-score 0.8336439458581765
Number of bad epochs 3
Current learning rate: 0.001
Epoch 28 - avg_train_loss: 0.1519             avg_val_loss: 0.5956  time: 101s
Epoch 28 - Accuracy: 0.8240294701048456 - F1-score 0.8219932946299395
Number of bad epochs 4
Current learning rate: 0.001
Epoch 29 - avg_train_loss: 0.1482             avg_val_loss: 0.5472  time: 101s
Epoch 29 - Accuracy: 0.8370643241711533 - F1-score 0.8358625634416181
Number of bad epochs 5
Current learning rate: 0.001
Epoch 30 - avg_train_loss: 0.1373             avg_val_loss: 0.5991  time: 102s
Epoch 30 - Accuracy: 0.8347973930291868 - F1-score 0.8341789055288908
Number of bad epochs 6
Current learning rate: 0.001
Epoch 31 - avg_train_loss: 0.1388             avg_val_loss: 0.5919  time: 102s
Epoch 31 - Accuracy: 0.8370643241711533 - F1-score 0.8364493679626454
Number of bad epochs 7
Current learning rate: 0.001
Epoch 32 - avg_train_loss: 0.1339             avg_val_loss: 0.6511  time: 103s
Epoch 32 - Accuracy: 0.8305468971379995 - F1-score 0.8291704906852443
Number of bad epochs 8
Current learning rate: 0.001
Epoch 33 - avg_train_loss: 0.1325             avg_val_loss: 0.6550  time: 102s
Epoch 33 - Accuracy: 0.8183621422499292 - F1-score 0.8210256828019954
Number of bad epochs 9
Current learning rate: 0.001
Epoch 34 - avg_train_loss: 0.1303             avg_val_loss: 0.6223  time: 102s
Epoch 34 - Accuracy: 0.8325304618872201 - F1-score 0.8307127871065603
Number of bad epochs 10
Current learning rate: 0.001
Epoch 35 - avg_train_loss: 0.1228             avg_val_loss: 0.7035  time: 102s
Epoch 35 - Accuracy: 0.821762538962879 - F1-score 0.8209647283227592
Number of bad epochs 11
Stop the training, since the score has not improved for 10 epochs!
AFTER TRAINING: Epoch 24: Best Accuracy: 0.8399 -                 Best F1-score: 0.8377
