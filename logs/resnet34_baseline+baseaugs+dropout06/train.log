Reading data...
train shape:
(28217, 2)
valid shape:
(3529, 2)
train fold:
label
0    10295
1     7526
2     3557
3     3530
4     2463
5      191
6      655
dtype: int64
validation fold:
label
0    1329
1     899
2     458
3     415
4     325
5      32
6      71
dtype: int64
Batch size 32
Input size 48
Select CrossEntropyLoss criterion
Enabling mixed precision for training...
Current learning rate: 0.001
Epoch 1 - avg_train_loss: 1.1271             avg_val_loss: 0.9721  time: 32s
Epoch 1 - Accuracy: 0.6511759705298952 - F1-score 0.6450103026766777
Epoch 1 - Save Best Accuracy: 0.6512 -                 Save Best F1-score: 0.6450 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 2 - avg_train_loss: 0.9020             avg_val_loss: 0.7752  time: 32s
Epoch 2 - Accuracy: 0.7245678662510626 - F1-score 0.7092942343757919
Epoch 2 - Save Best Accuracy: 0.7246 -                 Save Best F1-score: 0.7093 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 3 - avg_train_loss: 0.8915             avg_val_loss: 0.8267  time: 32s
Epoch 3 - Accuracy: 0.7058656843298384 - F1-score 0.6972568258979055
Number of bad epochs 1
Current learning rate: 0.001
Epoch 4 - avg_train_loss: 0.7811             avg_val_loss: 0.6940  time: 32s
Epoch 4 - Accuracy: 0.7548880702748654 - F1-score 0.7367110939312378
Epoch 4 - Save Best Accuracy: 0.7549 -                 Save Best F1-score: 0.7367 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 5 - avg_train_loss: 0.7367             avg_val_loss: 0.7561  time: 32s
Epoch 5 - Accuracy: 0.7376027203173704 - F1-score 0.7188874303957287
Number of bad epochs 1
Current learning rate: 0.001
Epoch 6 - avg_train_loss: 0.6954             avg_val_loss: 0.6480  time: 31s
Epoch 6 - Accuracy: 0.7684896571266647 - F1-score 0.7646748912761138
Epoch 6 - Save Best Accuracy: 0.7685 -                 Save Best F1-score: 0.7647 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 7 - avg_train_loss: 0.6566             avg_val_loss: 0.6106  time: 31s
Epoch 7 - Accuracy: 0.7849249079059224 - F1-score 0.7739144896716762
Epoch 7 - Save Best Accuracy: 0.7849 -                 Save Best F1-score: 0.7739 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 8 - avg_train_loss: 0.6340             avg_val_loss: 0.6111  time: 32s
Epoch 8 - Accuracy: 0.7803910456219892 - F1-score 0.7708040760534655
Number of bad epochs 1
Current learning rate: 0.001
Epoch 9 - avg_train_loss: 0.6319             avg_val_loss: 0.7715  time: 31s
Epoch 9 - Accuracy: 0.7282516293567582 - F1-score 0.721447213193503
Number of bad epochs 2
Current learning rate: 0.001
Epoch 10 - avg_train_loss: 0.6254             avg_val_loss: 0.6268  time: 32s
Epoch 10 - Accuracy: 0.7718900538396146 - F1-score 0.773082303656791
Number of bad epochs 3
Current learning rate: 0.001
Epoch 11 - avg_train_loss: 0.5659             avg_val_loss: 0.5890  time: 32s
Epoch 11 - Accuracy: 0.7971096627939926 - F1-score 0.7925606383588683
Epoch 11 - Save Best Accuracy: 0.7971 -                 Save Best F1-score: 0.7926 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 12 - avg_train_loss: 0.5410             avg_val_loss: 0.6310  time: 32s
Epoch 12 - Accuracy: 0.7840748087276849 - F1-score 0.781903299706891
Number of bad epochs 1
Current learning rate: 0.001
Epoch 13 - avg_train_loss: 0.5198             avg_val_loss: 0.5922  time: 32s
Epoch 13 - Accuracy: 0.8022102578634174 - F1-score 0.7907141785167078
Number of bad epochs 2
Current learning rate: 0.001
Epoch 14 - avg_train_loss: 0.5790             avg_val_loss: 0.5788  time: 32s
Epoch 14 - Accuracy: 0.7871918390478889 - F1-score 0.7804872908686942
Number of bad epochs 3
Current learning rate: 0.001
Epoch 15 - avg_train_loss: 0.4954             avg_val_loss: 0.5801  time: 31s
Epoch 15 - Accuracy: 0.8022102578634174 - F1-score 0.7988814598237978
Epoch 15 - Save Best Accuracy: 0.8022 -                 Save Best F1-score: 0.7989 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 16 - avg_train_loss: 0.4802             avg_val_loss: 0.5939  time: 31s
Epoch 16 - Accuracy: 0.7920090677245679 - F1-score 0.7907548641840406
Number of bad epochs 1
Current learning rate: 0.001
Epoch 17 - avg_train_loss: 0.4723             avg_val_loss: 0.6953  time: 31s
Epoch 17 - Accuracy: 0.7565882686313403 - F1-score 0.7538686318097716
Number of bad epochs 2
Current learning rate: 0.001
Epoch 18 - avg_train_loss: 0.4704             avg_val_loss: 0.5742  time: 31s
Epoch 18 - Accuracy: 0.7985264947577217 - F1-score 0.8003055304692792
Number of bad epochs 3
Current learning rate: 0.001
Epoch 19 - avg_train_loss: 0.4837             avg_val_loss: 0.5858  time: 33s
Epoch 19 - Accuracy: 0.7979597619722301 - F1-score 0.7929358352839267
Number of bad epochs 4
Current learning rate: 0.001
Epoch 20 - avg_train_loss: 0.4249             avg_val_loss: 0.5807  time: 32s
Epoch 20 - Accuracy: 0.8067441201473505 - F1-score 0.8029961950371536
Epoch 20 - Save Best Accuracy: 0.8067 -                 Save Best F1-score: 0.8030 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 21 - avg_train_loss: 0.3903             avg_val_loss: 0.6047  time: 32s
Epoch 21 - Accuracy: 0.8058940209691131 - F1-score 0.8011027186347159
Number of bad epochs 1
Current learning rate: 0.001
Epoch 22 - avg_train_loss: 0.3944             avg_val_loss: 0.6061  time: 31s
Epoch 22 - Accuracy: 0.8007934258996883 - F1-score 0.798918758551174
Number of bad epochs 2
Current learning rate: 0.001
Epoch 23 - avg_train_loss: 0.3989             avg_val_loss: 0.6074  time: 32s
Epoch 23 - Accuracy: 0.796542930008501 - F1-score 0.793317398405525
Number of bad epochs 3
Current learning rate: 0.001
Epoch 24 - avg_train_loss: 0.3748             avg_val_loss: 0.6104  time: 32s
Epoch 24 - Accuracy: 0.7979597619722301 - F1-score 0.7963563743013987
Number of bad epochs 4
Current learning rate: 0.001
Epoch 25 - avg_train_loss: 0.3561             avg_val_loss: 0.6556  time: 32s
Epoch 25 - Accuracy: 0.7982431283649759 - F1-score 0.7963229304200333
Number of bad epochs 5
Current learning rate: 0.001
Epoch 26 - avg_train_loss: 0.3478             avg_val_loss: 0.6104  time: 32s
Epoch 26 - Accuracy: 0.807594219325588 - F1-score 0.8017869137352868
Number of bad epochs 6
Current learning rate: 0.001
Epoch 27 - avg_train_loss: 0.3352             avg_val_loss: 0.6201  time: 31s
Epoch 27 - Accuracy: 0.8053272881836214 - F1-score 0.8048452953017885
Number of bad epochs 7
Current learning rate: 0.001
Epoch 28 - avg_train_loss: 0.3752             avg_val_loss: 0.6389  time: 32s
Epoch 28 - Accuracy: 0.7888920374043639 - F1-score 0.7825479947351337
Number of bad epochs 8
Current learning rate: 0.001
Epoch 29 - avg_train_loss: 0.3452             avg_val_loss: 0.6285  time: 32s
Epoch 29 - Accuracy: 0.8033437234344006 - F1-score 0.803563049268471
Number of bad epochs 9
Current learning rate: 0.001
Epoch 30 - avg_train_loss: 0.3069             avg_val_loss: 0.6405  time: 31s
Epoch 30 - Accuracy: 0.8081609521110796 - F1-score 0.8053983680048769
Epoch 30 - Save Best Accuracy: 0.8082 -                 Save Best F1-score: 0.8054 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 31 - avg_train_loss: 0.3021             avg_val_loss: 0.6793  time: 32s
Epoch 31 - Accuracy: 0.8030603570416549 - F1-score 0.802910603906487
Number of bad epochs 1
Current learning rate: 0.001
Epoch 32 - avg_train_loss: 0.2874             avg_val_loss: 0.6848  time: 32s
Epoch 32 - Accuracy: 0.7999433267214509 - F1-score 0.7976161011888966
Number of bad epochs 2
Current learning rate: 0.001
Epoch 33 - avg_train_loss: 0.2940             avg_val_loss: 0.6904  time: 31s
Epoch 33 - Accuracy: 0.796542930008501 - F1-score 0.7943622714855701
Number of bad epochs 3
Current learning rate: 0.001
Epoch 34 - avg_train_loss: 0.2901             avg_val_loss: 0.7349  time: 32s
Epoch 34 - Accuracy: 0.8005100595069424 - F1-score 0.8005138183446979
Number of bad epochs 4
Current learning rate: 0.001
Epoch 35 - avg_train_loss: 0.2839             avg_val_loss: 0.6707  time: 32s
Epoch 35 - Accuracy: 0.8073108529328422 - F1-score 0.8079595593474869
Number of bad epochs 5
Current learning rate: 0.001
Epoch 36 - avg_train_loss: 0.2632             avg_val_loss: 0.7063  time: 32s
Epoch 36 - Accuracy: 0.813828279965996 - F1-score 0.8105661513356238
Epoch 36 - Save Best Accuracy: 0.8138 -                 Save Best F1-score: 0.8106 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 37 - avg_train_loss: 0.2618             avg_val_loss: 0.7271  time: 32s
Epoch 37 - Accuracy: 0.8109946160385378 - F1-score 0.806365361638743
Number of bad epochs 1
Current learning rate: 0.001
Epoch 38 - avg_train_loss: 0.2883             avg_val_loss: 0.7709  time: 32s
Epoch 38 - Accuracy: 0.7931425332955512 - F1-score 0.7877996106633938
Number of bad epochs 2
Current learning rate: 0.001
Epoch 39 - avg_train_loss: 0.2609             avg_val_loss: 0.7418  time: 32s
Epoch 39 - Accuracy: 0.7973930291867385 - F1-score 0.7942625504065385
Number of bad epochs 3
Current learning rate: 0.001
Epoch 40 - avg_train_loss: 0.2399             avg_val_loss: 0.7670  time: 32s
Epoch 40 - Accuracy: 0.804477189005384 - F1-score 0.8027291209415374
Number of bad epochs 4
Current learning rate: 0.001
Epoch 41 - avg_train_loss: 0.2635             avg_val_loss: 0.7413  time: 32s
Epoch 41 - Accuracy: 0.7925758005100595 - F1-score 0.7926639746700026
Number of bad epochs 5
Current learning rate: 0.001
Epoch 42 - avg_train_loss: 0.2399             avg_val_loss: 0.7211  time: 31s
Epoch 42 - Accuracy: 0.8095777840748087 - F1-score 0.8050756060721971
Number of bad epochs 6
Current learning rate: 0.001
Epoch 43 - avg_train_loss: 0.2761             avg_val_loss: 0.7434  time: 32s
Epoch 43 - Accuracy: 0.7993765939359592 - F1-score 0.7951739997610616
Number of bad epochs 7
Current learning rate: 0.001
Epoch 44 - avg_train_loss: 0.2300             avg_val_loss: 0.7849  time: 32s
Epoch 44 - Accuracy: 0.7939926324737886 - F1-score 0.7947187939842251
Number of bad epochs 8
Current learning rate: 0.001
Epoch 45 - avg_train_loss: 0.2252             avg_val_loss: 0.7911  time: 31s
Epoch 45 - Accuracy: 0.8010767922924341 - F1-score 0.8003968018838535
Number of bad epochs 9
Current learning rate: 0.001
Epoch 46 - avg_train_loss: 0.2229             avg_val_loss: 0.7673  time: 31s
Epoch 46 - Accuracy: 0.8050439217908756 - F1-score 0.8013076867732654
Number of bad epochs 10
Current learning rate: 0.001
Epoch 47 - avg_train_loss: 0.2212             avg_val_loss: 0.8102  time: 32s
Epoch 47 - Accuracy: 0.7979597619722301 - F1-score 0.7975943983400263
Number of bad epochs 11
Stop the training, since the score has not improved for 10 epochs!
AFTER TRAINING: Epoch 36: Best Accuracy: 0.8138 -                 Best F1-score: 0.8106
