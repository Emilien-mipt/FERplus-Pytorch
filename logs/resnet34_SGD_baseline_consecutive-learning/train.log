Reading data...
train shape:
(28217, 2)
valid shape:
(3529, 2)
train fold:
label
0    10295
1     7526
2     3557
3     3530
4     2463
5      191
6      655
dtype: int64
validation fold:
label
0    1329
1     899
2     458
3     415
4     325
5      32
6      71
dtype: int64
Batch size 32
Input size 224
Select CrossEntropyLoss criterion
Enabling mixed precision for training...
Current learning rate: 0.02
Epoch 1 - avg_train_loss: 1.8529             avg_val_loss: 1.7263  time: 19s
Epoch 1 - Accuracy: 0.47520544063474074 - F1-score 0.43915030854645165
Epoch 1 - Save Best Accuracy: 0.4752 -                 Save Best F1-score: 0.4392 Model
Number of bad epochs 0
Current learning rate: 0.02
Epoch 2 - avg_train_loss: 1.8332             avg_val_loss: 1.6815  time: 18s
Epoch 2 - Accuracy: 0.4247662227259847 - F1-score 0.42814162240305775
Number of bad epochs 1
Current learning rate: 0.02
Epoch 3 - avg_train_loss: 1.8566             avg_val_loss: 1.9557  time: 18s
Epoch 3 - Accuracy: 0.43298384811561347 - F1-score 0.387983475219798
Number of bad epochs 2
Current learning rate: 0.02
Epoch 4 - avg_train_loss: 1.8187             avg_val_loss: 1.7993  time: 18s
Epoch 4 - Accuracy: 0.39586285066591104 - F1-score 0.4053220139004549
Number of bad epochs 3
Current learning rate: 0.002
Epoch 5 - avg_train_loss: 1.9001             avg_val_loss: 1.7594  time: 18s
Epoch 5 - Accuracy: 0.44545196939642956 - F1-score 0.4149741207325275
Number of bad epochs 4
Current learning rate: 0.002
Epoch 6 - avg_train_loss: 0.8156             avg_val_loss: 0.5681  time: 56s
Epoch 6 - Accuracy: 0.7931425332955512 - F1-score 0.7831723341196029
Epoch 6 - Save Best Accuracy: 0.7931 -                 Save Best F1-score: 0.7832 Model
Number of bad epochs 0
Current learning rate: 0.002
Epoch 7 - avg_train_loss: 0.5388             avg_val_loss: 0.5099  time: 56s
Epoch 7 - Accuracy: 0.8101445168603004 - F1-score 0.8129741390488714
Epoch 7 - Save Best Accuracy: 0.8101 -                 Save Best F1-score: 0.8130 Model
Number of bad epochs 0
Current learning rate: 0.002
Epoch 8 - avg_train_loss: 0.4514             avg_val_loss: 0.4580  time: 56s
Epoch 8 - Accuracy: 0.8282799659960328 - F1-score 0.8257382805365604
Epoch 8 - Save Best Accuracy: 0.8283 -                 Save Best F1-score: 0.8257 Model
Number of bad epochs 0
Current learning rate: 0.002
Epoch 9 - avg_train_loss: 0.3954             avg_val_loss: 0.4525  time: 56s
Epoch 9 - Accuracy: 0.8356474922074242 - F1-score 0.8326686909030944
Epoch 9 - Save Best Accuracy: 0.8356 -                 Save Best F1-score: 0.8327 Model
Number of bad epochs 0
Current learning rate: 0.002
Epoch 10 - avg_train_loss: 0.3511             avg_val_loss: 0.4427  time: 56s
Epoch 10 - Accuracy: 0.8384811561348824 - F1-score 0.837901202674066
Epoch 10 - Save Best Accuracy: 0.8385 -                 Save Best F1-score: 0.8379 Model
Number of bad epochs 0
Current learning rate: 0.002
Epoch 11 - avg_train_loss: 0.3140             avg_val_loss: 0.4642  time: 56s
Epoch 11 - Accuracy: 0.8390478889203741 - F1-score 0.8350840651635675
Number of bad epochs 1
Current learning rate: 0.002
Epoch 12 - avg_train_loss: 0.2759             avg_val_loss: 0.4888  time: 56s
Epoch 12 - Accuracy: 0.8316803627089827 - F1-score 0.832229155982959
Number of bad epochs 2
Current learning rate: 0.002
Epoch 13 - avg_train_loss: 0.2582             avg_val_loss: 0.4643  time: 56s
Epoch 13 - Accuracy: 0.8449985831680362 - F1-score 0.8422254171079858
Epoch 13 - Save Best Accuracy: 0.8450 -                 Save Best F1-score: 0.8422 Model
Number of bad epochs 0
Current learning rate: 0.002
Epoch 14 - avg_train_loss: 0.2316             avg_val_loss: 0.4892  time: 56s
Epoch 14 - Accuracy: 0.842164919240578 - F1-score 0.8408788807773447
Number of bad epochs 1
Current learning rate: 0.0002
Epoch 15 - avg_train_loss: 0.2100             avg_val_loss: 0.4888  time: 56s
Epoch 15 - Accuracy: 0.8475488807027487 - F1-score 0.8456253205544964
Epoch 15 - Save Best Accuracy: 0.8475 -                 Save Best F1-score: 0.8456 Model
Number of bad epochs 0
Current learning rate: 0.0002
Epoch 16 - avg_train_loss: 0.1564             avg_val_loss: 0.4757  time: 56s
Epoch 16 - Accuracy: 0.8500991782374611 - F1-score 0.8493605014466977
Epoch 16 - Save Best Accuracy: 0.8501 -                 Save Best F1-score: 0.8494 Model
Number of bad epochs 0
Current learning rate: 0.0002
Epoch 17 - avg_train_loss: 0.1416             avg_val_loss: 0.4788  time: 41s
Epoch 17 - Accuracy: 0.8529328421649193 - F1-score 0.8519932114878568
Epoch 17 - Save Best Accuracy: 0.8529 -                 Save Best F1-score: 0.8520 Model
Number of bad epochs 0
Current learning rate: 0.0002
Epoch 18 - avg_train_loss: 0.1407             avg_val_loss: 0.4729  time: 42s
Epoch 18 - Accuracy: 0.8520827429866817 - F1-score 0.851099568859902
Number of bad epochs 1
Current learning rate: 0.0002
Epoch 19 - avg_train_loss: 0.1439             avg_val_loss: 0.4717  time: 42s
Epoch 19 - Accuracy: 0.8554831396996316 - F1-score 0.85480969245183
Epoch 19 - Save Best Accuracy: 0.8555 -                 Save Best F1-score: 0.8548 Model
Number of bad epochs 0
Current learning rate: 0.0002
Epoch 20 - avg_train_loss: 0.1433             avg_val_loss: 0.4868  time: 41s
Epoch 20 - Accuracy: 0.8500991782374611 - F1-score 0.8492666476307901
Number of bad epochs 1
Current learning rate: 0.0002
Epoch 21 - avg_train_loss: 0.1413             avg_val_loss: 0.4709  time: 59s
Epoch 21 - Accuracy: 0.8503825446302069 - F1-score 0.8500743060727344
Number of bad epochs 2
Current learning rate: 0.0002
Epoch 22 - avg_train_loss: 0.1303             avg_val_loss: 0.4839  time: 59s
Epoch 22 - Accuracy: 0.8532162085576651 - F1-score 0.8523781065259092
Number of bad epochs 3
Current learning rate: 0.0002
Epoch 23 - avg_train_loss: 0.1254             avg_val_loss: 0.5047  time: 59s
Epoch 23 - Accuracy: 0.8481156134882403 - F1-score 0.8486768584392039
Number of bad epochs 4
Current learning rate: 0.0002
Epoch 24 - avg_train_loss: 0.1118             avg_val_loss: 0.5066  time: 59s
Epoch 24 - Accuracy: 0.8503825446302069 - F1-score 0.8492372788553263
Number of bad epochs 5
Current learning rate: 2e-05
Epoch 25 - avg_train_loss: 0.1105             avg_val_loss: 0.5179  time: 59s
Epoch 25 - Accuracy: 0.8515160102011902 - F1-score 0.8508063012942364
Number of bad epochs 6
Current learning rate: 2e-05
Epoch 26 - avg_train_loss: 0.1033             avg_val_loss: 0.5147  time: 59s
Epoch 26 - Accuracy: 0.8526494757721734 - F1-score 0.8513569582824037
Number of bad epochs 7
Current learning rate: 2e-05
Epoch 27 - avg_train_loss: 0.0998             avg_val_loss: 0.5075  time: 59s
Epoch 27 - Accuracy: 0.8503825446302069 - F1-score 0.8490505710414455
Number of bad epochs 8
Current learning rate: 2e-05
Epoch 28 - avg_train_loss: 0.0983             avg_val_loss: 0.5150  time: 59s
Epoch 28 - Accuracy: 0.8509492774156985 - F1-score 0.8503758940704399
Number of bad epochs 9
Current learning rate: 2e-05
Epoch 29 - avg_train_loss: 0.1034             avg_val_loss: 0.5086  time: 59s
Epoch 29 - Accuracy: 0.8500991782374611 - F1-score 0.8493141524044486
Number of bad epochs 10
Current learning rate: 2e-05
Epoch 30 - avg_train_loss: 0.0991             avg_val_loss: 0.5178  time: 59s
Epoch 30 - Accuracy: 0.8523661093794276 - F1-score 0.8515362338569855
Number of bad epochs 11
Stop the training, since the score has not improved for 10 epochs!
AFTER TRAINING: Epoch 19: Best Accuracy: 0.8555 -                 Best F1-score: 0.8548
