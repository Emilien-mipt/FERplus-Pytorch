Reading data...
train shape:
(28217, 2)
valid shape:
(3529, 2)
train fold:
label
0    10295
1     7526
2     3557
3     3530
4     2463
5      191
6      655
dtype: int64
validation fold:
label
0    1329
1     899
2     458
3     415
4     325
5      32
6      71
dtype: int64
Batch size 32
Input size 64
Select CrossEntropyLoss criterion
Enabling mixed precision for training...
Current learning rate: 0.001
Epoch 1 - avg_train_loss: 0.9770             avg_val_loss: 0.7590  time: 35s
Epoch 1 - Accuracy: 0.7197506375743836 - F1-score 0.7142885869127064
Epoch 1 - Save Best Accuracy: 0.7198 -                 Save Best F1-score: 0.7143 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 2 - avg_train_loss: 0.7638             avg_val_loss: 0.7145  time: 34s
Epoch 2 - Accuracy: 0.7327854916406914 - F1-score 0.7303353841907876
Epoch 2 - Save Best Accuracy: 0.7328 -                 Save Best F1-score: 0.7303 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 3 - avg_train_loss: 0.6892             avg_val_loss: 0.6034  time: 34s
Epoch 3 - Accuracy: 0.783791442334939 - F1-score 0.7682068482671762
Epoch 3 - Save Best Accuracy: 0.7838 -                 Save Best F1-score: 0.7682 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 4 - avg_train_loss: 0.6354             avg_val_loss: 0.7368  time: 34s
Epoch 4 - Accuracy: 0.742986681779541 - F1-score 0.7212610715455516
Number of bad epochs 1
Current learning rate: 0.001
Epoch 5 - avg_train_loss: 0.6055             avg_val_loss: 0.5871  time: 34s
Epoch 5 - Accuracy: 0.790308869368093 - F1-score 0.7819825165110362
Epoch 5 - Save Best Accuracy: 0.7903 -                 Save Best F1-score: 0.7820 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 6 - avg_train_loss: 0.5655             avg_val_loss: 0.5845  time: 34s
Epoch 6 - Accuracy: 0.7928591669028053 - F1-score 0.7880604508956984
Epoch 6 - Save Best Accuracy: 0.7929 -                 Save Best F1-score: 0.7881 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 7 - avg_train_loss: 0.5349             avg_val_loss: 0.5407  time: 34s
Epoch 7 - Accuracy: 0.7985264947577217 - F1-score 0.7958465085248537
Epoch 7 - Save Best Accuracy: 0.7985 -                 Save Best F1-score: 0.7958 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 8 - avg_train_loss: 0.5130             avg_val_loss: 0.5680  time: 34s
Epoch 8 - Accuracy: 0.7979597619722301 - F1-score 0.7925919004366334
Number of bad epochs 1
Current learning rate: 0.001
Epoch 9 - avg_train_loss: 0.4796             avg_val_loss: 0.5381  time: 34s
Epoch 9 - Accuracy: 0.8016435250779258 - F1-score 0.8001238574305631
Epoch 9 - Save Best Accuracy: 0.8016 -                 Save Best F1-score: 0.8001 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 10 - avg_train_loss: 0.4596             avg_val_loss: 0.5682  time: 34s
Epoch 10 - Accuracy: 0.7951260980447719 - F1-score 0.7962694212731116
Number of bad epochs 1
Current learning rate: 0.001
Epoch 11 - avg_train_loss: 0.4318             avg_val_loss: 0.5551  time: 34s
Epoch 11 - Accuracy: 0.7968262964012468 - F1-score 0.7945468188300226
Number of bad epochs 2
Current learning rate: 0.001
Epoch 12 - avg_train_loss: 0.4126             avg_val_loss: 0.5693  time: 34s
Epoch 12 - Accuracy: 0.7962595636157551 - F1-score 0.7967298149283347
Number of bad epochs 3
Current learning rate: 0.001
Epoch 13 - avg_train_loss: 0.3973             avg_val_loss: 0.5265  time: 34s
Epoch 13 - Accuracy: 0.8092944176820629 - F1-score 0.8052441721816755
Epoch 13 - Save Best Accuracy: 0.8093 -                 Save Best F1-score: 0.8052 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 14 - avg_train_loss: 0.3812             avg_val_loss: 0.5370  time: 34s
Epoch 14 - Accuracy: 0.8115613488240294 - F1-score 0.8086027492762313
Epoch 14 - Save Best Accuracy: 0.8116 -                 Save Best F1-score: 0.8086 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 15 - avg_train_loss: 0.3552             avg_val_loss: 0.5448  time: 34s
Epoch 15 - Accuracy: 0.8135449135732502 - F1-score 0.8110457564261006
Epoch 15 - Save Best Accuracy: 0.8135 -                 Save Best F1-score: 0.8110 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 16 - avg_train_loss: 0.3441             avg_val_loss: 0.5512  time: 34s
Epoch 16 - Accuracy: 0.8104278832530462 - F1-score 0.8089931179640655
Number of bad epochs 1
Current learning rate: 0.001
Epoch 17 - avg_train_loss: 0.3244             avg_val_loss: 0.5494  time: 34s
Epoch 17 - Accuracy: 0.8146783791442335 - F1-score 0.8129018340045651
Epoch 17 - Save Best Accuracy: 0.8147 -                 Save Best F1-score: 0.8129 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 18 - avg_train_loss: 0.3105             avg_val_loss: 0.5595  time: 34s
Epoch 18 - Accuracy: 0.809011051289317 - F1-score 0.8080069116845859
Number of bad epochs 1
Current learning rate: 0.001
Epoch 19 - avg_train_loss: 0.3020             avg_val_loss: 0.6066  time: 34s
Epoch 19 - Accuracy: 0.7939926324737886 - F1-score 0.7933713074912657
Number of bad epochs 2
Current learning rate: 0.001
Epoch 20 - avg_train_loss: 0.2901             avg_val_loss: 0.6096  time: 34s
Epoch 20 - Accuracy: 0.8087276848965713 - F1-score 0.8063206195683161
Number of bad epochs 3
Current learning rate: 0.001
Epoch 21 - avg_train_loss: 0.2721             avg_val_loss: 0.6169  time: 34s
Epoch 21 - Accuracy: 0.8126948143950128 - F1-score 0.8089149735508878
Number of bad epochs 4
Current learning rate: 0.001
Epoch 22 - avg_train_loss: 0.2649             avg_val_loss: 0.6241  time: 34s
Epoch 22 - Accuracy: 0.809011051289317 - F1-score 0.8070529064455534
Number of bad epochs 5
Current learning rate: 0.001
Epoch 23 - avg_train_loss: 0.2564             avg_val_loss: 0.6183  time: 34s
Epoch 23 - Accuracy: 0.8041938226126382 - F1-score 0.8038037017179126
Number of bad epochs 6
Current learning rate: 0.001
Epoch 24 - avg_train_loss: 0.2599             avg_val_loss: 0.6283  time: 34s
Epoch 24 - Accuracy: 0.8087276848965713 - F1-score 0.808476477265459
Number of bad epochs 7
Current learning rate: 0.001
Epoch 25 - avg_train_loss: 0.2393             avg_val_loss: 0.6872  time: 34s
Epoch 25 - Accuracy: 0.809011051289317 - F1-score 0.8089421734262587
Number of bad epochs 8
Current learning rate: 0.001
Epoch 26 - avg_train_loss: 0.2364             avg_val_loss: 0.6106  time: 34s
Epoch 26 - Accuracy: 0.8183621422499292 - F1-score 0.8150979489057089
Epoch 26 - Save Best Accuracy: 0.8184 -                 Save Best F1-score: 0.8151 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 27 - avg_train_loss: 0.2283             avg_val_loss: 0.6510  time: 34s
Epoch 27 - Accuracy: 0.812411448002267 - F1-score 0.8124292965057889
Number of bad epochs 1
Current learning rate: 0.001
Epoch 28 - avg_train_loss: 0.2427             avg_val_loss: 0.6769  time: 34s
Epoch 28 - Accuracy: 0.7871918390478889 - F1-score 0.7858054824227642
Number of bad epochs 2
Current learning rate: 0.001
Epoch 29 - avg_train_loss: 0.2295             avg_val_loss: 0.6689  time: 34s
Epoch 29 - Accuracy: 0.80136015868518 - F1-score 0.80215519710728
Number of bad epochs 3
Current learning rate: 0.001
Epoch 30 - avg_train_loss: 0.2017             avg_val_loss: 0.6890  time: 34s
Epoch 30 - Accuracy: 0.8053272881836214 - F1-score 0.8050597430933265
Number of bad epochs 4
Current learning rate: 0.001
Epoch 31 - avg_train_loss: 0.2008             avg_val_loss: 0.7530  time: 34s
Epoch 31 - Accuracy: 0.8070274865400964 - F1-score 0.8029972811134464
Number of bad epochs 5
Current learning rate: 0.001
Epoch 32 - avg_train_loss: 0.1922             avg_val_loss: 0.6829  time: 34s
Epoch 32 - Accuracy: 0.812411448002267 - F1-score 0.8100619788525305
Number of bad epochs 6
Current learning rate: 0.001
Epoch 33 - avg_train_loss: 0.1912             avg_val_loss: 0.7027  time: 35s
Epoch 33 - Accuracy: 0.8146783791442335 - F1-score 0.8123041731197728
Number of bad epochs 7
Current learning rate: 0.001
Epoch 34 - avg_train_loss: 0.1925             avg_val_loss: 0.7025  time: 34s
Epoch 34 - Accuracy: 0.810711249645792 - F1-score 0.8083429466733747
Number of bad epochs 8
Current learning rate: 0.001
Epoch 35 - avg_train_loss: 0.1818             avg_val_loss: 0.7394  time: 35s
Epoch 35 - Accuracy: 0.7985264947577217 - F1-score 0.7974615918533593
Number of bad epochs 9
Current learning rate: 0.001
Epoch 36 - avg_train_loss: 0.1800             avg_val_loss: 0.7305  time: 34s
Epoch 36 - Accuracy: 0.812411448002267 - F1-score 0.8088697843011114
Number of bad epochs 10
Current learning rate: 0.001
Epoch 37 - avg_train_loss: 0.1733             avg_val_loss: 0.7261  time: 34s
Epoch 37 - Accuracy: 0.8180787758571834 - F1-score 0.8144194411132383
Number of bad epochs 11
Stop the training, since the score has not improved for 10 epochs!
AFTER TRAINING: Epoch 26: Best Accuracy: 0.8184 -                 Best F1-score: 0.8151
