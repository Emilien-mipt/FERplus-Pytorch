Reading data...
train shape:
(28217, 2)
valid shape:
(3529, 2)
train fold:
label
0    10295
1     7526
2     3557
3     3530
4     2463
5      191
6      655
dtype: int64
validation fold:
label
0    1329
1     899
2     458
3     415
4     325
5      32
6      71
dtype: int64
Batch size 32
Input size 512
Select CrossEntropyLoss criterion
Enabling mixed precision for training...
Current learning rate: 0.001
Epoch 1 - avg_train_loss: 1.0705             avg_val_loss: 0.8651  time: 365s
Epoch 1 - Accuracy: 0.6857466704448852 - F1-score 0.666570159755559
Epoch 1 - Save Best Accuracy: 0.6857 -                 Save Best F1-score: 0.6666 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 2 - avg_train_loss: 0.7781             avg_val_loss: 0.6898  time: 365s
Epoch 2 - Accuracy: 0.742986681779541 - F1-score 0.7265691774717732
Epoch 2 - Save Best Accuracy: 0.7430 -                 Save Best F1-score: 0.7266 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 3 - avg_train_loss: 0.6675             avg_val_loss: 0.5806  time: 365s
Epoch 3 - Accuracy: 0.7917257013318221 - F1-score 0.7815171888352658
Epoch 3 - Save Best Accuracy: 0.7917 -                 Save Best F1-score: 0.7815 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 4 - avg_train_loss: 0.5943             avg_val_loss: 0.5622  time: 366s
Epoch 4 - Accuracy: 0.7942759988665344 - F1-score 0.7825211762150412
Epoch 4 - Save Best Accuracy: 0.7943 -                 Save Best F1-score: 0.7825 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 5 - avg_train_loss: 0.5555             avg_val_loss: 0.5658  time: 366s
Epoch 5 - Accuracy: 0.793425899688297 - F1-score 0.7834350815592548
Number of bad epochs 1
Current learning rate: 0.001
Epoch 6 - avg_train_loss: 0.5143             avg_val_loss: 0.5198  time: 365s
Epoch 6 - Accuracy: 0.8092944176820629 - F1-score 0.8029498997411386
Epoch 6 - Save Best Accuracy: 0.8093 -                 Save Best F1-score: 0.8029 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 7 - avg_train_loss: 0.4816             avg_val_loss: 0.4918  time: 365s
Epoch 7 - Accuracy: 0.8172286766789458 - F1-score 0.8161582316267529
Epoch 7 - Save Best Accuracy: 0.8172 -                 Save Best F1-score: 0.8162 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 8 - avg_train_loss: 0.4555             avg_val_loss: 0.5525  time: 365s
Epoch 8 - Accuracy: 0.8002266931141967 - F1-score 0.7929222859971885
Number of bad epochs 1
Current learning rate: 0.001
Epoch 9 - avg_train_loss: 0.4255             avg_val_loss: 0.4854  time: 366s
Epoch 9 - Accuracy: 0.8132615471805044 - F1-score 0.8130518347221389
Number of bad epochs 2
Current learning rate: 0.001
Epoch 10 - avg_train_loss: 0.4055             avg_val_loss: 0.5127  time: 366s
Epoch 10 - Accuracy: 0.8053272881836214 - F1-score 0.8092845526910504
Number of bad epochs 3
Current learning rate: 0.001
Epoch 11 - avg_train_loss: 0.3789             avg_val_loss: 0.4526  time: 366s
Epoch 11 - Accuracy: 0.8282799659960328 - F1-score 0.8242420363176783
Epoch 11 - Save Best Accuracy: 0.8283 -                 Save Best F1-score: 0.8242 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 12 - avg_train_loss: 0.3541             avg_val_loss: 0.5098  time: 366s
Epoch 12 - Accuracy: 0.8118447152167753 - F1-score 0.8074575974646471
Number of bad epochs 1
Current learning rate: 0.001
Epoch 13 - avg_train_loss: 0.3333             avg_val_loss: 0.5443  time: 366s
Epoch 13 - Accuracy: 0.8053272881836214 - F1-score 0.8000848225142201
Number of bad epochs 2
Current learning rate: 0.001
Epoch 14 - avg_train_loss: 0.3175             avg_val_loss: 0.4524  time: 366s
Epoch 14 - Accuracy: 0.837631056956645 - F1-score 0.8361446476872594
Epoch 14 - Save Best Accuracy: 0.8376 -                 Save Best F1-score: 0.8361 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 15 - avg_train_loss: 0.2950             avg_val_loss: 0.4576  time: 366s
Epoch 15 - Accuracy: 0.8254463020685747 - F1-score 0.8221710430660771
Number of bad epochs 1
Current learning rate: 0.001
Epoch 16 - avg_train_loss: 0.2770             avg_val_loss: 0.4613  time: 366s
Epoch 16 - Accuracy: 0.8387645225276282 - F1-score 0.8355166437002993
Number of bad epochs 2
Current learning rate: 0.001
Epoch 17 - avg_train_loss: 0.2563             avg_val_loss: 0.4739  time: 365s
Epoch 17 - Accuracy: 0.8336639274582035 - F1-score 0.8339398232980056
Number of bad epochs 3
Current learning rate: 0.001
Epoch 18 - avg_train_loss: 0.2452             avg_val_loss: 0.5096  time: 365s
Epoch 18 - Accuracy: 0.8302635307452536 - F1-score 0.8323222453006075
Number of bad epochs 4
Current learning rate: 0.001
Epoch 19 - avg_train_loss: 0.2310             avg_val_loss: 0.5535  time: 366s
Epoch 19 - Accuracy: 0.8254463020685747 - F1-score 0.8212384217386194
Number of bad epochs 5
Current learning rate: 0.001
Epoch 20 - avg_train_loss: 0.2229             avg_val_loss: 0.5142  time: 366s
Epoch 20 - Accuracy: 0.8350807594219326 - F1-score 0.8356649742331036
Number of bad epochs 6
Current learning rate: 0.001
Epoch 21 - avg_train_loss: 0.2067             avg_val_loss: 0.5413  time: 366s
Epoch 21 - Accuracy: 0.8308302635307453 - F1-score 0.8251743035025484
Number of bad epochs 7
Current learning rate: 0.001
Epoch 22 - avg_train_loss: 0.1974             avg_val_loss: 0.5408  time: 366s
Epoch 22 - Accuracy: 0.8373476905638991 - F1-score 0.83370570821693
Number of bad epochs 8
Current learning rate: 0.001
Epoch 23 - avg_train_loss: 0.1855             avg_val_loss: 0.5741  time: 366s
Epoch 23 - Accuracy: 0.8291300651742703 - F1-score 0.8251630023512747
Number of bad epochs 9
Current learning rate: 0.001
Epoch 24 - avg_train_loss: 0.1776             avg_val_loss: 0.5691  time: 366s
Epoch 24 - Accuracy: 0.8356474922074242 - F1-score 0.8327549697680338
Number of bad epochs 10
Current learning rate: 0.001
Epoch 25 - avg_train_loss: 0.1754             avg_val_loss: 0.5903  time: 365s
Epoch 25 - Accuracy: 0.8319637291017286 - F1-score 0.8314333819240061
Number of bad epochs 11
Stop the training, since the score has not improved for 10 epochs!
AFTER TRAINING: Epoch 14: Best Accuracy: 0.8388 -                 Best F1-score: 0.8361
