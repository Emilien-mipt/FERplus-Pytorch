Reading data...
train shape:
(28217, 2)
valid shape:
(3529, 2)
train fold:
label
0    10295
1     7526
2     3557
3     3530
4     2463
5      191
6      655
dtype: int64
validation fold:
label
0    1329
1     899
2     458
3     415
4     325
5      32
6      71
dtype: int64
Batch size 32
Input size 48
Select CrossEntropyLoss criterion
Enabling mixed precision for training...
Current learning rate: 0.001
Epoch 1 - avg_train_loss: 1.0773             avg_val_loss: 0.8581  time: 32s
Epoch 1 - Accuracy: 0.6882969679795976 - F1-score 0.6789514616854919
Epoch 1 - Save Best Accuracy: 0.6883 -                 Save Best F1-score: 0.6790 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 2 - avg_train_loss: 0.8903             avg_val_loss: 0.7683  time: 32s
Epoch 2 - Accuracy: 0.7285349957495041 - F1-score 0.7248196508457523
Epoch 2 - Save Best Accuracy: 0.7285 -                 Save Best F1-score: 0.7248 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 3 - avg_train_loss: 0.7960             avg_val_loss: 0.6854  time: 31s
Epoch 3 - Accuracy: 0.7656559931992065 - F1-score 0.7492363773694775
Epoch 3 - Save Best Accuracy: 0.7657 -                 Save Best F1-score: 0.7492 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 4 - avg_train_loss: 0.7319             avg_val_loss: 0.7851  time: 32s
Epoch 4 - Accuracy: 0.7313686596769623 - F1-score 0.7073376762235666
Number of bad epochs 1
Current learning rate: 0.001
Epoch 5 - avg_train_loss: 0.7015             avg_val_loss: 0.6581  time: 31s
Epoch 5 - Accuracy: 0.761688863700765 - F1-score 0.7392494549398168
Number of bad epochs 2
Current learning rate: 0.001
Epoch 6 - avg_train_loss: 0.6669             avg_val_loss: 0.6483  time: 32s
Epoch 6 - Accuracy: 0.7747237177670728 - F1-score 0.7645843410375172
Epoch 6 - Save Best Accuracy: 0.7747 -                 Save Best F1-score: 0.7646 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 7 - avg_train_loss: 0.6312             avg_val_loss: 0.6108  time: 32s
Epoch 7 - Accuracy: 0.7829413431567016 - F1-score 0.7791443009621077
Epoch 7 - Save Best Accuracy: 0.7829 -                 Save Best F1-score: 0.7791 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 8 - avg_train_loss: 0.6086             avg_val_loss: 0.6017  time: 32s
Epoch 8 - Accuracy: 0.7818078775857183 - F1-score 0.7763807787938147
Number of bad epochs 1
Current learning rate: 0.001
Epoch 9 - avg_train_loss: 0.5749             avg_val_loss: 0.5790  time: 32s
Epoch 9 - Accuracy: 0.7931425332955512 - F1-score 0.7867384723973909
Epoch 9 - Save Best Accuracy: 0.7931 -                 Save Best F1-score: 0.7867 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 10 - avg_train_loss: 0.5625             avg_val_loss: 0.5920  time: 32s
Epoch 10 - Accuracy: 0.7860583734769057 - F1-score 0.7830622125847083
Number of bad epochs 1
Current learning rate: 0.001
Epoch 11 - avg_train_loss: 0.5397             avg_val_loss: 0.5891  time: 32s
Epoch 11 - Accuracy: 0.7993765939359592 - F1-score 0.7913160902268848
Epoch 11 - Save Best Accuracy: 0.7994 -                 Save Best F1-score: 0.7913 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 12 - avg_train_loss: 0.5174             avg_val_loss: 0.6129  time: 32s
Epoch 12 - Accuracy: 0.7877585718333806 - F1-score 0.7838880309726187
Number of bad epochs 1
Current learning rate: 0.001
Epoch 13 - avg_train_loss: 0.5151             avg_val_loss: 0.5576  time: 32s
Epoch 13 - Accuracy: 0.8022102578634174 - F1-score 0.7948250604354964
Epoch 13 - Save Best Accuracy: 0.8022 -                 Save Best F1-score: 0.7948 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 14 - avg_train_loss: 0.4984             avg_val_loss: 0.5628  time: 31s
Epoch 14 - Accuracy: 0.8036270898271465 - F1-score 0.799733268791447
Epoch 14 - Save Best Accuracy: 0.8036 -                 Save Best F1-score: 0.7997 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 15 - avg_train_loss: 0.4651             avg_val_loss: 0.5632  time: 32s
Epoch 15 - Accuracy: 0.8024936242561632 - F1-score 0.7961546683578378
Number of bad epochs 1
Current learning rate: 0.001
Epoch 16 - avg_train_loss: 0.4457             avg_val_loss: 0.5994  time: 32s
Epoch 16 - Accuracy: 0.7990932275432133 - F1-score 0.7967156922327865
Number of bad epochs 2
Current learning rate: 0.001
Epoch 17 - avg_train_loss: 0.4347             avg_val_loss: 0.5704  time: 32s
Epoch 17 - Accuracy: 0.8010767922924341 - F1-score 0.7990429490739612
Number of bad epochs 3
Current learning rate: 0.001
Epoch 18 - avg_train_loss: 0.4240             avg_val_loss: 0.6122  time: 32s
Epoch 18 - Accuracy: 0.7939926324737886 - F1-score 0.7866181551527578
Number of bad epochs 4
Current learning rate: 0.001
Epoch 19 - avg_train_loss: 0.4089             avg_val_loss: 0.5907  time: 32s
Epoch 19 - Accuracy: 0.8053272881836214 - F1-score 0.8012707414563518
Epoch 19 - Save Best Accuracy: 0.8053 -                 Save Best F1-score: 0.8013 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 20 - avg_train_loss: 0.3874             avg_val_loss: 0.6033  time: 32s
Epoch 20 - Accuracy: 0.7999433267214509 - F1-score 0.799334105931819
Number of bad epochs 1
Current learning rate: 0.001
Epoch 21 - avg_train_loss: 0.3831             avg_val_loss: 0.5724  time: 32s
Epoch 21 - Accuracy: 0.8135449135732502 - F1-score 0.8091125715590759
Epoch 21 - Save Best Accuracy: 0.8135 -                 Save Best F1-score: 0.8091 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 22 - avg_train_loss: 0.3650             avg_val_loss: 0.6126  time: 32s
Epoch 22 - Accuracy: 0.8016435250779258 - F1-score 0.7982374250298104
Number of bad epochs 1
Current learning rate: 0.001
Epoch 23 - avg_train_loss: 0.3599             avg_val_loss: 0.6276  time: 32s
Epoch 23 - Accuracy: 0.7979597619722301 - F1-score 0.793733692262911
Number of bad epochs 2
Current learning rate: 0.001
Epoch 24 - avg_train_loss: 0.3567             avg_val_loss: 0.6130  time: 32s
Epoch 24 - Accuracy: 0.7973930291867385 - F1-score 0.7969931025079678
Number of bad epochs 3
Current learning rate: 0.001
Epoch 25 - avg_train_loss: 0.3431             avg_val_loss: 0.6485  time: 32s
Epoch 25 - Accuracy: 0.80136015868518 - F1-score 0.7988959035594996
Number of bad epochs 4
Current learning rate: 0.001
Epoch 26 - avg_train_loss: 0.3244             avg_val_loss: 0.6575  time: 31s
Epoch 26 - Accuracy: 0.799659960328705 - F1-score 0.792457405655274
Number of bad epochs 5
Current learning rate: 0.001
Epoch 27 - avg_train_loss: 0.3176             avg_val_loss: 0.6249  time: 32s
Epoch 27 - Accuracy: 0.8007934258996883 - F1-score 0.8006125553673044
Number of bad epochs 6
Current learning rate: 0.001
Epoch 28 - avg_train_loss: 0.3159             avg_val_loss: 0.6681  time: 32s
Epoch 28 - Accuracy: 0.7988098611504676 - F1-score 0.7957317840716093
Number of bad epochs 7
Current learning rate: 0.001
Epoch 29 - avg_train_loss: 0.3125             avg_val_loss: 0.6495  time: 32s
Epoch 29 - Accuracy: 0.8022102578634174 - F1-score 0.8002153752573962
Number of bad epochs 8
Current learning rate: 0.001
Epoch 30 - avg_train_loss: 0.2911             avg_val_loss: 0.6815  time: 32s
Epoch 30 - Accuracy: 0.80136015868518 - F1-score 0.7952258185676943
Number of bad epochs 9
Current learning rate: 0.001
Epoch 31 - avg_train_loss: 0.2880             avg_val_loss: 0.6777  time: 32s
Epoch 31 - Accuracy: 0.8087276848965713 - F1-score 0.8056494895176455
Number of bad epochs 10
Current learning rate: 0.001
Epoch 32 - avg_train_loss: 0.2776             avg_val_loss: 0.6817  time: 32s
Epoch 32 - Accuracy: 0.8010767922924341 - F1-score 0.7998073974036395
Number of bad epochs 11
Stop the training, since the score has not improved for 10 epochs!
AFTER TRAINING: Epoch 21: Best Accuracy: 0.8135 -                 Best F1-score: 0.8091
