Reading data...
train shape:
(28217, 2)
valid shape:
(3529, 2)
train fold:
label
0    10295
1     7526
2     3557
3     3530
4     2463
5      191
6      655
dtype: int64
validation fold:
label
0    1329
1     899
2     458
3     415
4     325
5      32
6      71
dtype: int64
Batch size 32
Input size 128
Select CrossEntropyLoss criterion
Enabling mixed precision for training...
Current learning rate: 0.001
Epoch 1 - avg_train_loss: 0.9165             avg_val_loss: 0.7670  time: 44s
Epoch 1 - Accuracy: 0.7276848965712667 - F1-score 0.7175263510543236
Epoch 1 - Save Best Accuracy: 0.7277 -                 Save Best F1-score: 0.7175 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 2 - avg_train_loss: 0.6975             avg_val_loss: 0.6197  time: 44s
Epoch 2 - Accuracy: 0.7738736185888354 - F1-score 0.7651402837663888
Epoch 2 - Save Best Accuracy: 0.7739 -                 Save Best F1-score: 0.7651 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 3 - avg_train_loss: 0.6246             avg_val_loss: 0.5806  time: 44s
Epoch 3 - Accuracy: 0.790308869368093 - F1-score 0.7753862209768378
Epoch 3 - Save Best Accuracy: 0.7903 -                 Save Best F1-score: 0.7754 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 4 - avg_train_loss: 0.5726             avg_val_loss: 0.5553  time: 44s
Epoch 4 - Accuracy: 0.7928591669028053 - F1-score 0.7838218403229763
Epoch 4 - Save Best Accuracy: 0.7929 -                 Save Best F1-score: 0.7838 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 5 - avg_train_loss: 0.5415             avg_val_loss: 0.5314  time: 45s
Epoch 5 - Accuracy: 0.8024936242561632 - F1-score 0.7962291533600414
Epoch 5 - Save Best Accuracy: 0.8025 -                 Save Best F1-score: 0.7962 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 6 - avg_train_loss: 0.4982             avg_val_loss: 0.5134  time: 44s
Epoch 6 - Accuracy: 0.8203457069991499 - F1-score 0.8135518859928914
Epoch 6 - Save Best Accuracy: 0.8203 -                 Save Best F1-score: 0.8136 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 7 - avg_train_loss: 0.4735             avg_val_loss: 0.4897  time: 45s
Epoch 7 - Accuracy: 0.8223292717483707 - F1-score 0.8179990930592644
Epoch 7 - Save Best Accuracy: 0.8223 -                 Save Best F1-score: 0.8180 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 8 - avg_train_loss: 0.4472             avg_val_loss: 0.5112  time: 44s
Epoch 8 - Accuracy: 0.8115613488240294 - F1-score 0.8090578591046791
Number of bad epochs 1
Current learning rate: 0.001
Epoch 9 - avg_train_loss: 0.4201             avg_val_loss: 0.4906  time: 44s
Epoch 9 - Accuracy: 0.8163785775007084 - F1-score 0.8143455580558354
Number of bad epochs 2
Current learning rate: 0.001
Epoch 10 - avg_train_loss: 0.3941             avg_val_loss: 0.4920  time: 44s
Epoch 10 - Accuracy: 0.821762538962879 - F1-score 0.8219314267708312
Number of bad epochs 3
Current learning rate: 0.001
Epoch 11 - avg_train_loss: 0.3712             avg_val_loss: 0.5016  time: 44s
Epoch 11 - Accuracy: 0.8180787758571834 - F1-score 0.8115753776632789
Number of bad epochs 4
Current learning rate: 0.001
Epoch 12 - avg_train_loss: 0.3451             avg_val_loss: 0.5133  time: 44s
Epoch 12 - Accuracy: 0.815528478322471 - F1-score 0.8160553930244093
Number of bad epochs 5
Current learning rate: 0.001
Epoch 13 - avg_train_loss: 0.3258             avg_val_loss: 0.5204  time: 44s
Epoch 13 - Accuracy: 0.8194956078209125 - F1-score 0.8163665057335768
Number of bad epochs 6
Current learning rate: 0.001
Epoch 14 - avg_train_loss: 0.3116             avg_val_loss: 0.4972  time: 44s
Epoch 14 - Accuracy: 0.821762538962879 - F1-score 0.8203679633291828
Number of bad epochs 7
Current learning rate: 0.001
Epoch 15 - avg_train_loss: 0.2875             avg_val_loss: 0.5014  time: 44s
Epoch 15 - Accuracy: 0.8262964012468121 - F1-score 0.825654748667504
Epoch 15 - Save Best Accuracy: 0.8263 -                 Save Best F1-score: 0.8257 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 16 - avg_train_loss: 0.2747             avg_val_loss: 0.5056  time: 45s
Epoch 16 - Accuracy: 0.8345140266364409 - F1-score 0.832928238576629
Epoch 16 - Save Best Accuracy: 0.8345 -                 Save Best F1-score: 0.8329 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 17 - avg_train_loss: 0.2590             avg_val_loss: 0.5022  time: 45s
Epoch 17 - Accuracy: 0.8356474922074242 - F1-score 0.8345291873475484
Epoch 17 - Save Best Accuracy: 0.8356 -                 Save Best F1-score: 0.8345 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 18 - avg_train_loss: 0.2421             avg_val_loss: 0.5381  time: 44s
Epoch 18 - Accuracy: 0.8254463020685747 - F1-score 0.825998978801965
Number of bad epochs 1
Current learning rate: 0.001
Epoch 19 - avg_train_loss: 0.2369             avg_val_loss: 0.5533  time: 44s
Epoch 19 - Accuracy: 0.8288466987815245 - F1-score 0.8291842842365448
Number of bad epochs 2
Current learning rate: 0.001
Epoch 20 - avg_train_loss: 0.2267             avg_val_loss: 0.5538  time: 44s
Epoch 20 - Accuracy: 0.8336639274582035 - F1-score 0.8326821829936644
Number of bad epochs 3
Current learning rate: 0.001
Epoch 21 - avg_train_loss: 0.2068             avg_val_loss: 0.6006  time: 44s
Epoch 21 - Accuracy: 0.8226126381411165 - F1-score 0.8206868558684592
Number of bad epochs 4
Current learning rate: 0.001
Epoch 22 - avg_train_loss: 0.2061             avg_val_loss: 0.6014  time: 44s
Epoch 22 - Accuracy: 0.824879569283083 - F1-score 0.821604256329994
Number of bad epochs 5
Current learning rate: 0.001
Epoch 23 - avg_train_loss: 0.1981             avg_val_loss: 0.5776  time: 44s
Epoch 23 - Accuracy: 0.8231793709266081 - F1-score 0.8245564355856483
Number of bad epochs 6
Current learning rate: 0.001
Epoch 24 - avg_train_loss: 0.1855             avg_val_loss: 0.6058  time: 44s
Epoch 24 - Accuracy: 0.8285633323887787 - F1-score 0.8268671367587852
Number of bad epochs 7
Current learning rate: 0.001
Epoch 25 - avg_train_loss: 0.1824             avg_val_loss: 0.6018  time: 44s
Epoch 25 - Accuracy: 0.8302635307452536 - F1-score 0.8275073210995953
Number of bad epochs 8
Current learning rate: 0.001
Epoch 26 - avg_train_loss: 0.1747             avg_val_loss: 0.6064  time: 44s
Epoch 26 - Accuracy: 0.8240294701048456 - F1-score 0.8231836882598466
Number of bad epochs 9
Current learning rate: 0.001
Epoch 27 - avg_train_loss: 0.1707             avg_val_loss: 0.6049  time: 44s
Epoch 27 - Accuracy: 0.8209124397846416 - F1-score 0.8189747398165776
Number of bad epochs 10
Current learning rate: 0.001
Epoch 28 - avg_train_loss: 0.1632             avg_val_loss: 0.6159  time: 44s
Epoch 28 - Accuracy: 0.8302635307452536 - F1-score 0.826748495847332
Number of bad epochs 11
Stop the training, since the score has not improved for 10 epochs!
AFTER TRAINING: Epoch 17: Best Accuracy: 0.8356 -                 Best F1-score: 0.8345
