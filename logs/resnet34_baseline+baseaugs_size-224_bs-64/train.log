Reading data...
train shape:
(28217, 2)
valid shape:
(3529, 2)
train fold:
label
0    10295
1     7526
2     3557
3     3530
4     2463
5      191
6      655
dtype: int64
validation fold:
label
0    1329
1     899
2     458
3     415
4     325
5      32
6      71
dtype: int64
Batch size 64
Input size 224
Select CrossEntropyLoss criterion
Enabling mixed precision for training...
Current learning rate: 0.001
Epoch 1 - avg_train_loss: 0.8657             avg_val_loss: 0.7025  time: 73s
Epoch 1 - Accuracy: 0.7449702465287616 - F1-score 0.7335080243201743
Epoch 1 - Save Best Accuracy: 0.7450 -                 Save Best F1-score: 0.7335 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 2 - avg_train_loss: 0.6466             avg_val_loss: 0.5895  time: 73s
Epoch 2 - Accuracy: 0.7883253046188722 - F1-score 0.7760309987739576
Epoch 2 - Save Best Accuracy: 0.7883 -                 Save Best F1-score: 0.7760 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 3 - avg_train_loss: 0.5726             avg_val_loss: 0.5679  time: 73s
Epoch 3 - Accuracy: 0.7942759988665344 - F1-score 0.7897938586416163
Epoch 3 - Save Best Accuracy: 0.7943 -                 Save Best F1-score: 0.7898 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 4 - avg_train_loss: 0.5204             avg_val_loss: 0.5390  time: 74s
Epoch 4 - Accuracy: 0.8024936242561632 - F1-score 0.7982314402943922
Epoch 4 - Save Best Accuracy: 0.8025 -                 Save Best F1-score: 0.7982 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 5 - avg_train_loss: 0.4835             avg_val_loss: 0.5180  time: 74s
Epoch 5 - Accuracy: 0.8022102578634174 - F1-score 0.7962256863702448
Number of bad epochs 1
Current learning rate: 0.001
Epoch 6 - avg_train_loss: 0.4503             avg_val_loss: 0.4984  time: 74s
Epoch 6 - Accuracy: 0.8118447152167753 - F1-score 0.8049623252367147
Epoch 6 - Save Best Accuracy: 0.8118 -                 Save Best F1-score: 0.8050 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 7 - avg_train_loss: 0.4259             avg_val_loss: 0.4824  time: 74s
Epoch 7 - Accuracy: 0.8175120430716917 - F1-score 0.818942666841732
Epoch 7 - Save Best Accuracy: 0.8175 -                 Save Best F1-score: 0.8189 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 8 - avg_train_loss: 0.4016             avg_val_loss: 0.4780  time: 74s
Epoch 8 - Accuracy: 0.8214791725701331 - F1-score 0.8161212064395658
Number of bad epochs 1
Current learning rate: 0.001
Epoch 9 - avg_train_loss: 0.3769             avg_val_loss: 0.4799  time: 74s
Epoch 9 - Accuracy: 0.8209124397846416 - F1-score 0.8234448798884296
Number of bad epochs 2
Current learning rate: 0.001
Epoch 10 - avg_train_loss: 0.3557             avg_val_loss: 0.4407  time: 74s
Epoch 10 - Accuracy: 0.8418815528478323 - F1-score 0.839864525252972
Epoch 10 - Save Best Accuracy: 0.8419 -                 Save Best F1-score: 0.8399 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 11 - avg_train_loss: 0.3397             avg_val_loss: 0.5055  time: 74s
Epoch 11 - Accuracy: 0.8183621422499292 - F1-score 0.8147955135162945
Number of bad epochs 1
Current learning rate: 0.001
Epoch 12 - avg_train_loss: 0.3145             avg_val_loss: 0.4944  time: 74s
Epoch 12 - Accuracy: 0.8175120430716917 - F1-score 0.8188754789895829
Number of bad epochs 2
Current learning rate: 0.001
Epoch 13 - avg_train_loss: 0.2945             avg_val_loss: 0.4895  time: 73s
Epoch 13 - Accuracy: 0.8260130348540663 - F1-score 0.8202436382064942
Number of bad epochs 3
Current learning rate: 0.001
Epoch 14 - avg_train_loss: 0.2809             avg_val_loss: 0.4963  time: 74s
Epoch 14 - Accuracy: 0.8308302635307453 - F1-score 0.8268514617142407
Number of bad epochs 4
Current learning rate: 0.001
Epoch 15 - avg_train_loss: 0.2611             avg_val_loss: 0.4899  time: 74s
Epoch 15 - Accuracy: 0.8364975913856617 - F1-score 0.8320455782797277
Number of bad epochs 5
Current learning rate: 0.001
Epoch 16 - avg_train_loss: 0.2484             avg_val_loss: 0.4843  time: 73s
Epoch 16 - Accuracy: 0.8353641258146783 - F1-score 0.832484503383923
Number of bad epochs 6
Current learning rate: 0.001
Epoch 17 - avg_train_loss: 0.2312             avg_val_loss: 0.4972  time: 74s
Epoch 17 - Accuracy: 0.8305468971379995 - F1-score 0.8290607944517979
Number of bad epochs 7
Current learning rate: 0.001
Epoch 18 - avg_train_loss: 0.2228             avg_val_loss: 0.5030  time: 74s
Epoch 18 - Accuracy: 0.8268631340323037 - F1-score 0.827873879709371
Number of bad epochs 8
Current learning rate: 0.001
Epoch 19 - avg_train_loss: 0.2030             avg_val_loss: 0.5211  time: 74s
Epoch 19 - Accuracy: 0.8285633323887787 - F1-score 0.8287290305151414
Number of bad epochs 9
Current learning rate: 0.001
Epoch 20 - avg_train_loss: 0.2018             avg_val_loss: 0.4934  time: 73s
Epoch 20 - Accuracy: 0.8350807594219326 - F1-score 0.8337108307478334
Number of bad epochs 10
Current learning rate: 0.001
Epoch 21 - avg_train_loss: 0.1862             avg_val_loss: 0.5392  time: 74s
Epoch 21 - Accuracy: 0.8333805610654577 - F1-score 0.8333251207232769
Number of bad epochs 11
Stop the training, since the score has not improved for 10 epochs!
AFTER TRAINING: Epoch 10: Best Accuracy: 0.8419 -                 Best F1-score: 0.8399
