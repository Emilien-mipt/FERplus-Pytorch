Reading data...
train shape:
(28217, 2)
valid shape:
(3529, 2)
train fold:
label
0    10295
1     7526
2     3557
3     3530
4     2463
5      191
6      655
dtype: int64
validation fold:
label
0    1329
1     899
2     458
3     415
4     325
5      32
6      71
dtype: int64
Batch size 32
Input size 48
Select CrossEntropyLoss criterion
Enabling mixed precision for training...
Current learning rate: 0.001
Epoch 1 - avg_train_loss: 1.0366             avg_val_loss: 0.8017  time: 32s
Epoch 1 - Accuracy: 0.7149334088977047 - F1-score 0.7041880678997294
Epoch 1 - Save Best Accuracy: 0.7149 -                 Save Best F1-score: 0.7042 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 2 - avg_train_loss: 0.8172             avg_val_loss: 0.7563  time: 32s
Epoch 2 - Accuracy: 0.7225843015018418 - F1-score 0.7131577587416875
Epoch 2 - Save Best Accuracy: 0.7226 -                 Save Best F1-score: 0.7132 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 3 - avg_train_loss: 0.7419             avg_val_loss: 0.6622  time: 32s
Epoch 3 - Accuracy: 0.7707565882686314 - F1-score 0.7574075600229677
Epoch 3 - Save Best Accuracy: 0.7708 -                 Save Best F1-score: 0.7574 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 4 - avg_train_loss: 0.6907             avg_val_loss: 0.7236  time: 32s
Epoch 4 - Accuracy: 0.7401530178520828 - F1-score 0.7280043972325512
Number of bad epochs 1
Current learning rate: 0.001
Epoch 5 - avg_train_loss: 0.6638             avg_val_loss: 0.7208  time: 31s
Epoch 5 - Accuracy: 0.7427033153867951 - F1-score 0.7187617119646385
Number of bad epochs 2
Current learning rate: 0.001
Epoch 6 - avg_train_loss: 0.6181             avg_val_loss: 0.6157  time: 31s
Epoch 6 - Accuracy: 0.7755738169453102 - F1-score 0.772097635637225
Epoch 6 - Save Best Accuracy: 0.7756 -                 Save Best F1-score: 0.7721 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 7 - avg_train_loss: 0.5851             avg_val_loss: 0.5853  time: 32s
Epoch 7 - Accuracy: 0.783791442334939 - F1-score 0.7799685894796645
Epoch 7 - Save Best Accuracy: 0.7838 -                 Save Best F1-score: 0.7800 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 8 - avg_train_loss: 0.5704             avg_val_loss: 0.5731  time: 31s
Epoch 8 - Accuracy: 0.7922924341173136 - F1-score 0.7853861890522398
Epoch 8 - Save Best Accuracy: 0.7923 -                 Save Best F1-score: 0.7854 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 9 - avg_train_loss: 0.5353             avg_val_loss: 0.5571  time: 32s
Epoch 9 - Accuracy: 0.7971096627939926 - F1-score 0.7907330043164178
Epoch 9 - Save Best Accuracy: 0.7971 -                 Save Best F1-score: 0.7907 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 10 - avg_train_loss: 0.5372             avg_val_loss: 0.6121  time: 31s
Epoch 10 - Accuracy: 0.7670728251629356 - F1-score 0.7728989987558121
Number of bad epochs 1
Current learning rate: 0.001
Epoch 11 - avg_train_loss: 0.4962             avg_val_loss: 0.6030  time: 32s
Epoch 11 - Accuracy: 0.7937092660810428 - F1-score 0.7851892468346283
Number of bad epochs 2
Current learning rate: 0.001
Epoch 12 - avg_train_loss: 0.4696             avg_val_loss: 0.6021  time: 32s
Epoch 12 - Accuracy: 0.7880419382261263 - F1-score 0.7853506349116943
Number of bad epochs 3
Current learning rate: 0.001
Epoch 13 - avg_train_loss: 0.4478             avg_val_loss: 0.5633  time: 32s
Epoch 13 - Accuracy: 0.8033437234344006 - F1-score 0.7960104342455936
Epoch 13 - Save Best Accuracy: 0.8033 -                 Save Best F1-score: 0.7960 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 14 - avg_train_loss: 0.4365             avg_val_loss: 0.5757  time: 32s
Epoch 14 - Accuracy: 0.7976763955794842 - F1-score 0.795619344058157
Number of bad epochs 1
Current learning rate: 0.001
Epoch 15 - avg_train_loss: 0.4109             avg_val_loss: 0.5692  time: 32s
Epoch 15 - Accuracy: 0.80136015868518 - F1-score 0.7989335513148853
Number of bad epochs 2
Current learning rate: 0.001
Epoch 16 - avg_train_loss: 0.4316             avg_val_loss: 0.5737  time: 31s
Epoch 16 - Accuracy: 0.7985264947577217 - F1-score 0.7983174030704537
Number of bad epochs 3
Current learning rate: 0.001
Epoch 17 - avg_train_loss: 0.3781             avg_val_loss: 0.5896  time: 32s
Epoch 17 - Accuracy: 0.7951260980447719 - F1-score 0.7940728599278271
Number of bad epochs 4
Current learning rate: 0.001
Epoch 18 - avg_train_loss: 0.3613             avg_val_loss: 0.5830  time: 31s
Epoch 18 - Accuracy: 0.7976763955794842 - F1-score 0.7983628568783494
Number of bad epochs 5
Current learning rate: 0.001
Epoch 19 - avg_train_loss: 0.3558             avg_val_loss: 0.5869  time: 32s
Epoch 19 - Accuracy: 0.8101445168603004 - F1-score 0.8081737233366585
Epoch 19 - Save Best Accuracy: 0.8101 -                 Save Best F1-score: 0.8082 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 20 - avg_train_loss: 0.3406             avg_val_loss: 0.6015  time: 32s
Epoch 20 - Accuracy: 0.8024936242561632 - F1-score 0.8031794399679797
Number of bad epochs 1
Current learning rate: 0.001
Epoch 21 - avg_train_loss: 0.3310             avg_val_loss: 0.7657  time: 31s
Epoch 21 - Accuracy: 0.7877585718333806 - F1-score 0.7820097465473281
Number of bad epochs 2
Current learning rate: 0.001
Epoch 22 - avg_train_loss: 0.3241             avg_val_loss: 0.6159  time: 32s
Epoch 22 - Accuracy: 0.7971096627939926 - F1-score 0.7923937348076514
Number of bad epochs 3
Current learning rate: 0.001
Epoch 23 - avg_train_loss: 0.3090             avg_val_loss: 0.6685  time: 32s
Epoch 23 - Accuracy: 0.7999433267214509 - F1-score 0.7964357045735957
Number of bad epochs 4
Current learning rate: 0.001
Epoch 24 - avg_train_loss: 0.3014             avg_val_loss: 0.6500  time: 32s
Epoch 24 - Accuracy: 0.7971096627939926 - F1-score 0.7965272277675481
Number of bad epochs 5
Current learning rate: 0.001
Epoch 25 - avg_train_loss: 0.2923             avg_val_loss: 0.6601  time: 32s
Epoch 25 - Accuracy: 0.8036270898271465 - F1-score 0.7968306334829992
Number of bad epochs 6
Current learning rate: 0.001
Epoch 26 - avg_train_loss: 0.2798             avg_val_loss: 0.6664  time: 32s
Epoch 26 - Accuracy: 0.7985264947577217 - F1-score 0.7962267642245567
Number of bad epochs 7
Current learning rate: 0.001
Epoch 27 - avg_train_loss: 0.2766             avg_val_loss: 0.6738  time: 32s
Epoch 27 - Accuracy: 0.7905922357608388 - F1-score 0.7889614105634974
Number of bad epochs 8
Current learning rate: 0.001
Epoch 28 - avg_train_loss: 0.2645             avg_val_loss: 0.7388  time: 32s
Epoch 28 - Accuracy: 0.7880419382261263 - F1-score 0.7862111193927339
Number of bad epochs 9
Current learning rate: 0.001
Epoch 29 - avg_train_loss: 0.2650             avg_val_loss: 0.6796  time: 32s
Epoch 29 - Accuracy: 0.7945593652592803 - F1-score 0.7945644838105452
Number of bad epochs 10
Current learning rate: 0.001
Epoch 30 - avg_train_loss: 0.2527             avg_val_loss: 0.6933  time: 32s
Epoch 30 - Accuracy: 0.7990932275432133 - F1-score 0.7959537525162665
Number of bad epochs 11
Stop the training, since the score has not improved for 10 epochs!
AFTER TRAINING: Epoch 19: Best Accuracy: 0.8101 -                 Best F1-score: 0.8082
