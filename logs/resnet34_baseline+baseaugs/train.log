Reading data...
train shape:
(28217, 2)
valid shape:
(3529, 2)
train fold:
label
0    10295
1     7526
2     3557
3     3530
4     2463
5      191
6      655
dtype: int64
validation fold:
label
0    1329
1     899
2     458
3     415
4     325
5      32
6      71
dtype: int64
Creating dir to save samples of a batch...
Saving figures of a single batch...
Figures have been saved!
Batch size 32
Input size 48
Select CrossEntropyLoss criterion
Enabling mixed precision for training...
Current learning rate: 0.001
Epoch 1 - avg_train_loss: 1.0378             avg_val_loss: 0.9214  time: 33s
Epoch 1 - Accuracy: 0.6916973646925475 - F1-score 0.6652656606101311
Epoch 1 - Save Best Accuracy: 0.6917 -                 Save Best F1-score: 0.6653 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 2 - avg_train_loss: 0.8188             avg_val_loss: 0.7633  time: 33s
Epoch 2 - Accuracy: 0.731935392462454 - F1-score 0.7166386029238451
Epoch 2 - Save Best Accuracy: 0.7319 -                 Save Best F1-score: 0.7166 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 3 - avg_train_loss: 0.7430             avg_val_loss: 0.7023  time: 33s
Epoch 3 - Accuracy: 0.7452536129215075 - F1-score 0.745702504179794
Epoch 3 - Save Best Accuracy: 0.7453 -                 Save Best F1-score: 0.7457 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 4 - avg_train_loss: 0.6869             avg_val_loss: 0.6898  time: 32s
Epoch 4 - Accuracy: 0.752337772740153 - F1-score 0.7462872176798537
Epoch 4 - Save Best Accuracy: 0.7523 -                 Save Best F1-score: 0.7463 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 5 - avg_train_loss: 0.6496             avg_val_loss: 0.6611  time: 32s
Epoch 5 - Accuracy: 0.7605553981297818 - F1-score 0.758095916515843
Epoch 5 - Save Best Accuracy: 0.7606 -                 Save Best F1-score: 0.7581 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 6 - avg_train_loss: 0.6162             avg_val_loss: 0.6424  time: 32s
Epoch 6 - Accuracy: 0.7699064890903938 - F1-score 0.7642668666928397
Epoch 6 - Save Best Accuracy: 0.7699 -                 Save Best F1-score: 0.7643 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 7 - avg_train_loss: 0.6118             avg_val_loss: 0.6119  time: 32s
Epoch 7 - Accuracy: 0.7806744120147351 - F1-score 0.7695109864643901
Epoch 7 - Save Best Accuracy: 0.7807 -                 Save Best F1-score: 0.7695 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 8 - avg_train_loss: 0.5668             avg_val_loss: 0.6193  time: 32s
Epoch 8 - Accuracy: 0.779257580051006 - F1-score 0.7735693898855702
Number of bad epochs 1
Current learning rate: 0.001
Epoch 9 - avg_train_loss: 0.5413             avg_val_loss: 0.6879  time: 32s
Epoch 9 - Accuracy: 0.7495041088126948 - F1-score 0.7496515982744163
Number of bad epochs 2
Current learning rate: 0.001
Epoch 10 - avg_train_loss: 0.5152             avg_val_loss: 0.5827  time: 32s
Epoch 10 - Accuracy: 0.793425899688297 - F1-score 0.7871308306417509
Epoch 10 - Save Best Accuracy: 0.7934 -                 Save Best F1-score: 0.7871 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 11 - avg_train_loss: 0.4963             avg_val_loss: 0.6032  time: 32s
Epoch 11 - Accuracy: 0.7803910456219892 - F1-score 0.767800068852766
Number of bad epochs 1
Current learning rate: 0.001
Epoch 12 - avg_train_loss: 0.4760             avg_val_loss: 0.5937  time: 32s
Epoch 12 - Accuracy: 0.788608671011618 - F1-score 0.7806713321846469
Number of bad epochs 2
Current learning rate: 0.001
Epoch 13 - avg_train_loss: 0.4483             avg_val_loss: 0.5751  time: 33s
Epoch 13 - Accuracy: 0.7857750070841598 - F1-score 0.7814566343794921
Number of bad epochs 3
Current learning rate: 0.001
Epoch 14 - avg_train_loss: 0.4456             avg_val_loss: 0.5599  time: 32s
Epoch 14 - Accuracy: 0.8095777840748087 - F1-score 0.8038736177849649
Epoch 14 - Save Best Accuracy: 0.8096 -                 Save Best F1-score: 0.8039 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 15 - avg_train_loss: 0.4157             avg_val_loss: 0.5981  time: 32s
Epoch 15 - Accuracy: 0.8022102578634174 - F1-score 0.7957822406975313
Number of bad epochs 1
Current learning rate: 0.001
Epoch 16 - avg_train_loss: 0.3969             avg_val_loss: 0.5765  time: 32s
Epoch 16 - Accuracy: 0.8058940209691131 - F1-score 0.8050850760117376
Number of bad epochs 2
Current learning rate: 0.001
Epoch 17 - avg_train_loss: 0.3819             avg_val_loss: 0.5852  time: 32s
Epoch 17 - Accuracy: 0.8084443185038255 - F1-score 0.8036333174702438
Number of bad epochs 3
Current learning rate: 0.001
Epoch 18 - avg_train_loss: 0.3925             avg_val_loss: 0.6199  time: 32s
Epoch 18 - Accuracy: 0.7951260980447719 - F1-score 0.7954212561130792
Number of bad epochs 4
Current learning rate: 0.001
Epoch 19 - avg_train_loss: 0.3534             avg_val_loss: 0.6109  time: 32s
Epoch 19 - Accuracy: 0.8039104562198923 - F1-score 0.7995345637431404
Number of bad epochs 5
Current learning rate: 0.001
Epoch 20 - avg_train_loss: 0.3515             avg_val_loss: 0.6112  time: 32s
Epoch 20 - Accuracy: 0.8041938226126382 - F1-score 0.8024467238968577
Number of bad epochs 6
Current learning rate: 0.001
Epoch 21 - avg_train_loss: 0.3264             avg_val_loss: 0.6621  time: 32s
Epoch 21 - Accuracy: 0.7863417398696515 - F1-score 0.7853691965739108
Number of bad epochs 7
Current learning rate: 0.001
Epoch 22 - avg_train_loss: 0.3130             avg_val_loss: 0.6577  time: 32s
Epoch 22 - Accuracy: 0.8033437234344006 - F1-score 0.7995734703839641
Number of bad epochs 8
Current learning rate: 0.001
Epoch 23 - avg_train_loss: 0.3053             avg_val_loss: 0.6790  time: 32s
Epoch 23 - Accuracy: 0.7917257013318221 - F1-score 0.794224290662213
Number of bad epochs 9
Current learning rate: 0.001
Epoch 24 - avg_train_loss: 0.3021             avg_val_loss: 0.6505  time: 32s
Epoch 24 - Accuracy: 0.8095777840748087 - F1-score 0.8067267269587644
Epoch 24 - Save Best Accuracy: 0.8096 -                 Save Best F1-score: 0.8067 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 25 - avg_train_loss: 0.2916             avg_val_loss: 0.6816  time: 32s
Epoch 25 - Accuracy: 0.7956928308302635 - F1-score 0.7948813459787116
Number of bad epochs 1
Current learning rate: 0.001
Epoch 26 - avg_train_loss: 0.2776             avg_val_loss: 0.6951  time: 32s
Epoch 26 - Accuracy: 0.7988098611504676 - F1-score 0.7957437485505207
Number of bad epochs 2
Current learning rate: 0.001
Epoch 27 - avg_train_loss: 0.2688             avg_val_loss: 0.6612  time: 32s
Epoch 27 - Accuracy: 0.7954094644375177 - F1-score 0.7955156249777958
Number of bad epochs 3
Current learning rate: 0.001
Epoch 28 - avg_train_loss: 0.2628             avg_val_loss: 0.6867  time: 32s
Epoch 28 - Accuracy: 0.7993765939359592 - F1-score 0.7983210217409427
Number of bad epochs 4
Current learning rate: 0.001
Epoch 29 - avg_train_loss: 0.2552             avg_val_loss: 0.6650  time: 32s
Epoch 29 - Accuracy: 0.8005100595069424 - F1-score 0.7974725601438535
Number of bad epochs 5
Current learning rate: 0.001
Epoch 30 - avg_train_loss: 0.2393             avg_val_loss: 0.7468  time: 33s
Epoch 30 - Accuracy: 0.80136015868518 - F1-score 0.7983776515905529
Number of bad epochs 6
Current learning rate: 0.001
Epoch 31 - avg_train_loss: 0.2405             avg_val_loss: 0.7420  time: 32s
Epoch 31 - Accuracy: 0.7976763955794842 - F1-score 0.7952950476966323
Number of bad epochs 7
Current learning rate: 0.001
Epoch 32 - avg_train_loss: 0.2406             avg_val_loss: 0.7076  time: 32s
Epoch 32 - Accuracy: 0.7917257013318221 - F1-score 0.7922102629969107
Number of bad epochs 8
Current learning rate: 0.001
Epoch 33 - avg_train_loss: 0.2345             avg_val_loss: 0.7585  time: 32s
Epoch 33 - Accuracy: 0.7905922357608388 - F1-score 0.7896897685817089
Number of bad epochs 9
Current learning rate: 0.001
Epoch 34 - avg_train_loss: 0.2564             avg_val_loss: 0.7564  time: 32s
Epoch 34 - Accuracy: 0.8030603570416549 - F1-score 0.8005491077064658
Number of bad epochs 10
Current learning rate: 0.001
Epoch 35 - avg_train_loss: 0.2486             avg_val_loss: 0.7467  time: 32s
Epoch 35 - Accuracy: 0.8081609521110796 - F1-score 0.8046056863965696
Number of bad epochs 11
Stop the training, since the score has not improved for 10 epochs!
AFTER TRAINING: Epoch 24: Best Accuracy: 0.8096 -                 Best F1-score: 0.8067
