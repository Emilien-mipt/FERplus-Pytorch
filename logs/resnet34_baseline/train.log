Reading data...
train shape:
(28217, 2)
valid shape:
(3529, 2)
train fold:
label
0    10295
1     7526
2     3557
3     3530
4     2463
5      191
6      655
dtype: int64
validation fold:
label
0    1329
1     899
2     458
3     415
4     325
5      32
6      71
dtype: int64
Model name resnet34
Batch size 32
Input size 48
Select CrossEntropyLoss criterion
Enabling mixed precision for training...
Current learning rate: 0.001
Epoch 1 - avg_train_loss: 0.9814             avg_val_loss: 0.8004  time: 32s
Epoch 1 - Accuracy: 0.7047322187588552 - F1-score 0.7030143012544672
Epoch 1 - Save Best Accuracy: 0.7047 -                 Save Best F1-score: 0.7030 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 2 - avg_train_loss: 0.7221             avg_val_loss: 0.6900  time: 31s
Epoch 2 - Accuracy: 0.7500708415981865 - F1-score 0.7441235930768763
Epoch 2 - Save Best Accuracy: 0.7501 -                 Save Best F1-score: 0.7441 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 3 - avg_train_loss: 0.6151             avg_val_loss: 0.6493  time: 31s
Epoch 3 - Accuracy: 0.7735902521960896 - F1-score 0.7614178061385449
Epoch 3 - Save Best Accuracy: 0.7736 -                 Save Best F1-score: 0.7614 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 4 - avg_train_loss: 0.5131             avg_val_loss: 0.7349  time: 32s
Epoch 4 - Accuracy: 0.7480872768489657 - F1-score 0.729566137288758
Number of bad epochs 1
Current learning rate: 0.001
Epoch 5 - avg_train_loss: 0.4293             avg_val_loss: 0.7402  time: 32s
Epoch 5 - Accuracy: 0.7455369793142533 - F1-score 0.7326464961250355
Number of bad epochs 2
Current learning rate: 0.001
Epoch 6 - avg_train_loss: 0.3435             avg_val_loss: 0.7225  time: 31s
Epoch 6 - Accuracy: 0.7713233210541229 - F1-score 0.7626633661376767
Number of bad epochs 3
Current learning rate: 0.001
Epoch 7 - avg_train_loss: 0.2664             avg_val_loss: 0.6965  time: 31s
Epoch 7 - Accuracy: 0.7852082742986681 - F1-score 0.7835504725906118
Epoch 7 - Save Best Accuracy: 0.7852 -                 Save Best F1-score: 0.7836 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 8 - avg_train_loss: 0.2195             avg_val_loss: 0.7733  time: 31s
Epoch 8 - Accuracy: 0.7718900538396146 - F1-score 0.7741907491674476
Number of bad epochs 1
Current learning rate: 0.001
Epoch 9 - avg_train_loss: 0.1771             avg_val_loss: 0.8177  time: 31s
Epoch 9 - Accuracy: 0.7767072825162936 - F1-score 0.7751521360596093
Number of bad epochs 2
Current learning rate: 0.001
Epoch 10 - avg_train_loss: 0.1483             avg_val_loss: 0.8286  time: 31s
Epoch 10 - Accuracy: 0.7764239161235478 - F1-score 0.7747143279848692
Number of bad epochs 3
Current learning rate: 0.001
Epoch 11 - avg_train_loss: 0.1335             avg_val_loss: 0.8881  time: 31s
Epoch 11 - Accuracy: 0.788608671011618 - F1-score 0.7840841194685968
Epoch 11 - Save Best Accuracy: 0.7886 -                 Save Best F1-score: 0.7841 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 12 - avg_train_loss: 0.1174             avg_val_loss: 0.9149  time: 31s
Epoch 12 - Accuracy: 0.7721734202323605 - F1-score 0.7736126714527453
Number of bad epochs 1
Current learning rate: 0.001
Epoch 13 - avg_train_loss: 0.1125             avg_val_loss: 1.0948  time: 31s
Epoch 13 - Accuracy: 0.7761405497308019 - F1-score 0.7660087156260117
Number of bad epochs 2
Current learning rate: 0.001
Epoch 14 - avg_train_loss: 0.1053             avg_val_loss: 1.0410  time: 31s
Epoch 14 - Accuracy: 0.7812411448002267 - F1-score 0.7784030923718231
Number of bad epochs 3
Current learning rate: 0.001
Epoch 15 - avg_train_loss: 0.0943             avg_val_loss: 0.9919  time: 31s
Epoch 15 - Accuracy: 0.7829413431567016 - F1-score 0.7794050900325212
Number of bad epochs 4
Current learning rate: 0.001
Epoch 16 - avg_train_loss: 0.0909             avg_val_loss: 1.0259  time: 31s
Epoch 16 - Accuracy: 0.7860583734769057 - F1-score 0.7834559812248197
Number of bad epochs 5
Current learning rate: 0.001
Epoch 17 - avg_train_loss: 0.0814             avg_val_loss: 1.1583  time: 31s
Epoch 17 - Accuracy: 0.7704732218758855 - F1-score 0.7667100836060308
Number of bad epochs 6
Current learning rate: 0.001
Epoch 18 - avg_train_loss: 0.0736             avg_val_loss: 1.1303  time: 31s
Epoch 18 - Accuracy: 0.7594219325587985 - F1-score 0.761214595302105
Number of bad epochs 7
Current learning rate: 0.001
Epoch 19 - avg_train_loss: 0.0787             avg_val_loss: 1.1472  time: 31s
Epoch 19 - Accuracy: 0.7724567866251063 - F1-score 0.7714523464793221
Number of bad epochs 8
Current learning rate: 0.001
Epoch 20 - avg_train_loss: 0.0711             avg_val_loss: 1.1105  time: 31s
Epoch 20 - Accuracy: 0.7750070841598187 - F1-score 0.7745335061235644
Number of bad epochs 9
Current learning rate: 0.001
Epoch 21 - avg_train_loss: 0.0699             avg_val_loss: 1.1137  time: 31s
Epoch 21 - Accuracy: 0.772740153017852 - F1-score 0.770128517226548
Number of bad epochs 10
Current learning rate: 0.001
Epoch 22 - avg_train_loss: 0.0667             avg_val_loss: 1.2028  time: 31s
Epoch 22 - Accuracy: 0.7803910456219892 - F1-score 0.7792663088822592
Number of bad epochs 11
Stop the training, since the score has not improved for 10 epochs!
AFTER TRAINING: Epoch 11: Best Accuracy: 0.7886 -                 Best F1-score: 0.7841
