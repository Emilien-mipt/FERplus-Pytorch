Reading data...
train shape:
(28217, 2)
valid shape:
(3529, 2)
train fold:
label
0    10295
1     7526
2     3557
3     3530
4     2463
5      191
6      655
dtype: int64
validation fold:
label
0    1329
1     899
2     458
3     415
4     325
5      32
6      71
dtype: int64
Batch size 32
Input size 224
Select CrossEntropyLoss criterion
Enabling mixed precision for training...
Current learning rate: 0.016661320097691452
Epoch 1 - avg_train_loss: 0.8678             avg_val_loss: 0.6669  time: 58s
Epoch 1 - Accuracy: 0.7520544063474072 - F1-score 0.7499920063382448
Epoch 1 - Save Best Accuracy: 0.7521 -                 Save Best F1-score: 0.7500 Model
Number of bad epochs 0
Current learning rate: 0.016776554506402083
Epoch 2 - avg_train_loss: 0.6084             avg_val_loss: 0.5518  time: 58s
Epoch 2 - Accuracy: 0.7968262964012468 - F1-score 0.7885073776197458
Epoch 2 - Save Best Accuracy: 0.7968 -                 Save Best F1-score: 0.7885 Model
Number of bad epochs 0
Current learning rate: 0.019967472231514745
Epoch 3 - avg_train_loss: 0.5055             avg_val_loss: 0.5528  time: 58s
Epoch 3 - Accuracy: 0.7993765939359592 - F1-score 0.7799982033685695
Number of bad epochs 1
Current learning rate: 0.016833774725619154
Epoch 4 - avg_train_loss: 0.4907             avg_val_loss: 0.4909  time: 58s
Epoch 4 - Accuracy: 0.8177954094644375 - F1-score 0.8088364832095306
Epoch 4 - Save Best Accuracy: 0.8178 -                 Save Best F1-score: 0.8088 Model
Number of bad epochs 0
Current learning rate: 0.011757427994889437
Epoch 5 - avg_train_loss: 0.4182             avg_val_loss: 0.4344  time: 59s
Epoch 5 - Accuracy: 0.8364975913856617 - F1-score 0.8346275891701544
Epoch 5 - Save Best Accuracy: 0.8365 -                 Save Best F1-score: 0.8346 Model
Number of bad epochs 0
Current learning rate: 0.019970872510587143
Epoch 6 - avg_train_loss: 0.3558             avg_val_loss: 0.5075  time: 59s
Epoch 6 - Accuracy: 0.8126948143950128 - F1-score 0.8127391616495552
Number of bad epochs 1
Current learning rate: 0.018984750832071857
Epoch 7 - avg_train_loss: 0.3978             avg_val_loss: 0.4546  time: 59s
Epoch 7 - Accuracy: 0.8214791725701331 - F1-score 0.8194924072703529
Number of bad epochs 2
Current learning rate: 0.01686228181229226
Epoch 8 - avg_train_loss: 0.3601             avg_val_loss: 0.4677  time: 59s
Epoch 8 - Accuracy: 0.831113629923491 - F1-score 0.8307708128381907
Number of bad epochs 3
Current learning rate: 0.014208738435478686
Epoch 9 - avg_train_loss: 0.3135             avg_val_loss: 0.4638  time: 59s
Epoch 9 - Accuracy: 0.8296967979597619 - F1-score 0.8294015414299943
Number of bad epochs 4
Current learning rate: 0.011780842285551044
Epoch 10 - avg_train_loss: 0.2684             avg_val_loss: 0.4544  time: 59s
Epoch 10 - Accuracy: 0.8367809577784074 - F1-score 0.8361425106151351
Epoch 10 - Save Best Accuracy: 0.8368 -                 Save Best F1-score: 0.8361 Model
Number of bad epochs 0
Current learning rate: 0.010270966223725761
Epoch 11 - avg_train_loss: 0.2312             avg_val_loss: 0.4885  time: 59s
Epoch 11 - Accuracy: 0.8396146217058656 - F1-score 0.8364967209781575
Epoch 11 - Save Best Accuracy: 0.8396 -                 Save Best F1-score: 0.8365 Model
Number of bad epochs 0
Current learning rate: 0.01997250247639664
Epoch 12 - avg_train_loss: 0.2233             avg_val_loss: 0.5820  time: 59s
Epoch 12 - Accuracy: 0.8135449135732502 - F1-score 0.8128406262325705
Number of bad epochs 1
Current learning rate: 0.01965215030452281
Epoch 13 - avg_train_loss: 0.2887             avg_val_loss: 0.5084  time: 59s
Epoch 13 - Accuracy: 0.8260130348540663 - F1-score 0.8211580553799537
Number of bad epochs 2
Current learning rate: 0.018993997999681787
Epoch 14 - avg_train_loss: 0.2614             avg_val_loss: 0.4968  time: 59s
Epoch 14 - Accuracy: 0.8299801643525078 - F1-score 0.8295519284165093
Number of bad epochs 3
Current learning rate: 0.018045835061682267
Epoch 15 - avg_train_loss: 0.2387             avg_val_loss: 0.5080  time: 59s
Epoch 15 - Accuracy: 0.8277132332105412 - F1-score 0.827150707192671
Number of bad epochs 4
Current learning rate: 0.01687650912990928
Epoch 16 - avg_train_loss: 0.2154             avg_val_loss: 0.5332  time: 59s
Epoch 16 - Accuracy: 0.8404647208841032 - F1-score 0.8367958957923433
Epoch 16 - Save Best Accuracy: 0.8405 -                 Save Best F1-score: 0.8368 Model
Number of bad epochs 0
Current learning rate: 0.015570926845244764
Epoch 17 - avg_train_loss: 0.1947             avg_val_loss: 0.5104  time: 59s
Epoch 17 - Accuracy: 0.8387645225276282 - F1-score 0.8384452545521346
Number of bad epochs 1
Current learning rate: 0.01422388864200197
Epoch 18 - avg_train_loss: 0.1708             avg_val_loss: 0.5197  time: 59s
Epoch 18 - Accuracy: 0.8424482856333239 - F1-score 0.8416682402133236
Epoch 18 - Save Best Accuracy: 0.8424 -                 Save Best F1-score: 0.8417 Model
Number of bad epochs 0
Current learning rate: 0.01293320513556985
Epoch 19 - avg_train_loss: 0.1528             avg_val_loss: 0.5347  time: 59s
Epoch 19 - Accuracy: 0.8381977897421365 - F1-score 0.836528913296568
Number of bad epochs 1
Current learning rate: 0.011792594935957084
Epoch 20 - avg_train_loss: 0.1397             avg_val_loss: 0.5587  time: 59s
Epoch 20 - Accuracy: 0.8435817512043071 - F1-score 0.8425085839968992
Epoch 20 - Save Best Accuracy: 0.8436 -                 Save Best F1-score: 0.8425 Model
Number of bad epochs 0
Current learning rate: 0.010884879588443143
Epoch 21 - avg_train_loss: 0.1242             avg_val_loss: 0.5625  time: 59s
Epoch 21 - Accuracy: 0.8424482856333239 - F1-score 0.8411014269562946
Number of bad epochs 1
Current learning rate: 0.010275969767665611
Epoch 22 - avg_train_loss: 0.1156             avg_val_loss: 0.6063  time: 59s
Epoch 22 - Accuracy: 0.8472655143100029 - F1-score 0.8452736108556798
Epoch 22 - Save Best Accuracy: 0.8473 -                 Save Best F1-score: 0.8453 Model
Number of bad epochs 0
Current learning rate: 0.01001007939728549
Epoch 23 - avg_train_loss: 0.1058             avg_val_loss: 0.6070  time: 59s
Epoch 23 - Accuracy: 0.8379144233493908 - F1-score 0.8383516573339121
Number of bad epochs 1
Current learning rate: 0.019973299909085397
Epoch 24 - avg_train_loss: 0.1391             avg_val_loss: 0.6026  time: 59s
Epoch 24 - Accuracy: 0.8345140266364409 - F1-score 0.833664272657183
Number of bad epochs 2
Current learning rate: 0.019858427000210045
Epoch 25 - avg_train_loss: 0.1706             avg_val_loss: 0.5829  time: 59s
Epoch 25 - Accuracy: 0.8390478889203741 - F1-score 0.8380225922022156
Number of bad epochs 3
Current learning rate: 0.019654955615879433
Epoch 26 - avg_train_loss: 0.1622             avg_val_loss: 0.5757  time: 59s
Epoch 26 - Accuracy: 0.8291300651742703 - F1-score 0.8290722683257257
Number of bad epochs 4
Current learning rate: 0.019366596268662682
Epoch 27 - avg_train_loss: 0.1608             avg_val_loss: 0.5839  time: 59s
Epoch 27 - Accuracy: 0.8296967979597619 - F1-score 0.8302436914580522
Number of bad epochs 5
Current learning rate: 0.018998607491526456
Epoch 28 - avg_train_loss: 0.1464             avg_val_loss: 0.6005  time: 59s
Epoch 28 - Accuracy: 0.8362142249929159 - F1-score 0.8326599426590144
Number of bad epochs 6
Current learning rate: 0.01855769994301054
Epoch 29 - avg_train_loss: 0.1356             avg_val_loss: 0.6062  time: 59s
Epoch 29 - Accuracy: 0.8333805610654577 - F1-score 0.833193389531943
Number of bad epochs 7
Current learning rate: 0.018051914031381545
Epoch 30 - avg_train_loss: 0.1281             avg_val_loss: 0.5898  time: 59s
Epoch 30 - Accuracy: 0.840748087276849 - F1-score 0.8406039504996625
Number of bad epochs 8
Current learning rate: 0.01749047328941565
Epoch 31 - avg_train_loss: 0.1164             avg_val_loss: 0.6045  time: 59s
Epoch 31 - Accuracy: 0.8387645225276282 - F1-score 0.8382464479701417
Number of bad epochs 9
Current learning rate: 0.016883616173673895
Epoch 32 - avg_train_loss: 0.1107             avg_val_loss: 0.6219  time: 59s
Epoch 32 - Accuracy: 0.8381977897421365 - F1-score 0.8381813740100473
Number of bad epochs 10
Current learning rate: 0.016242409355585442
Epoch 33 - avg_train_loss: 0.1072             avg_val_loss: 0.6281  time: 59s
Epoch 33 - Accuracy: 0.8353641258146783 - F1-score 0.8344631316218141
Number of bad epochs 11
Stop the training, since the score has not improved for 10 epochs!
AFTER TRAINING: Epoch 22: Best Accuracy: 0.8473 -                 Best F1-score: 0.8453
