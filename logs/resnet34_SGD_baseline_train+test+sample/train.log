Reading data...
train shape:
(42443, 2)
valid shape:
(3529, 2)
train fold:
label
0    10295
1     7526
2     6807
3     6799
4     5568
5     1688
6     3760
dtype: int64
validation fold:
label
0    1329
1     899
2     458
3     415
4     325
5      32
6      71
dtype: int64
Batch size 32
Input size 224
Select CrossEntropyLoss criterion
Current learning rate: 0.015
Epoch 1 - avg_train_loss: 0.8738             avg_val_loss: 0.5836  time: 105s
Epoch 1 - Accuracy: 0.7922924341173136 - F1-score 0.7942323703575345
Epoch 1 - Save Best Accuracy: 0.7923 -                 Save Best F1-score: 0.7942 Model
Number of bad epochs 0
Current learning rate: 0.02
Epoch 2 - avg_train_loss: 0.5355             avg_val_loss: 0.5725  time: 105s
Epoch 2 - Accuracy: 0.7840748087276849 - F1-score 0.7893297391431864
Number of bad epochs 1
Current learning rate: 0.015
Epoch 3 - avg_train_loss: 0.4226             avg_val_loss: 0.5207  time: 106s
Epoch 3 - Accuracy: 0.8019268914706715 - F1-score 0.805167893880439
Epoch 3 - Save Best Accuracy: 0.8019 -                 Save Best F1-score: 0.8052 Model
Number of bad epochs 0
Current learning rate: 0.01
Epoch 4 - avg_train_loss: 0.3519             avg_val_loss: 0.5161  time: 106s
Epoch 4 - Accuracy: 0.8231793709266081 - F1-score 0.8226872825533945
Epoch 4 - Save Best Accuracy: 0.8232 -                 Save Best F1-score: 0.8227 Model
Number of bad epochs 0
Current learning rate: 0.0125
Epoch 5 - avg_train_loss: 0.3023             avg_val_loss: 0.6078  time: 106s
Epoch 5 - Accuracy: 0.7962595636157551 - F1-score 0.7995297860735004
Number of bad epochs 1
Current learning rate: 0.015
Epoch 6 - avg_train_loss: 0.2669             avg_val_loss: 0.5160  time: 106s
Epoch 6 - Accuracy: 0.826579767639558 - F1-score 0.8272501571166843
Epoch 6 - Save Best Accuracy: 0.8266 -                 Save Best F1-score: 0.8273 Model
Number of bad epochs 0
Current learning rate: 0.0125
Epoch 7 - avg_train_loss: 0.2386             avg_val_loss: 0.5297  time: 106s
Epoch 7 - Accuracy: 0.8271465004250496 - F1-score 0.826662969548848
Number of bad epochs 1
Current learning rate: 0.01
Epoch 8 - avg_train_loss: 0.2099             avg_val_loss: 0.5329  time: 106s
Epoch 8 - Accuracy: 0.8347973930291868 - F1-score 0.8350103017985665
Epoch 8 - Save Best Accuracy: 0.8348 -                 Save Best F1-score: 0.8350 Model
Number of bad epochs 0
Current learning rate: 0.01125
Epoch 9 - avg_train_loss: 0.1917             avg_val_loss: 0.5484  time: 106s
Epoch 9 - Accuracy: 0.8288466987815245 - F1-score 0.8289309127873988
Number of bad epochs 1
Current learning rate: 0.0125
Epoch 10 - avg_train_loss: 0.1740             avg_val_loss: 0.5778  time: 106s
Epoch 10 - Accuracy: 0.8387645225276282 - F1-score 0.8372036439552233
Epoch 10 - Save Best Accuracy: 0.8388 -                 Save Best F1-score: 0.8372 Model
Number of bad epochs 0
Current learning rate: 0.01125
Epoch 11 - avg_train_loss: 0.1622             avg_val_loss: 0.5920  time: 106s
Epoch 11 - Accuracy: 0.83593085860017 - F1-score 0.8346546749850919
Number of bad epochs 1
Current learning rate: 0.01
Epoch 12 - avg_train_loss: 0.1449             avg_val_loss: 0.6012  time: 106s
Epoch 12 - Accuracy: 0.8401813544913573 - F1-score 0.8388567686117178
Epoch 12 - Save Best Accuracy: 0.8402 -                 Save Best F1-score: 0.8389 Model
Number of bad epochs 0
Current learning rate: 0.010625
Epoch 13 - avg_train_loss: 0.1333             avg_val_loss: 0.6304  time: 106s
Epoch 13 - Accuracy: 0.832813828279966 - F1-score 0.8322372806034365
Number of bad epochs 1
Current learning rate: 0.01125
Epoch 14 - avg_train_loss: 0.1285             avg_val_loss: 0.6564  time: 106s
Epoch 14 - Accuracy: 0.8404647208841032 - F1-score 0.8403713378738951
Epoch 14 - Save Best Accuracy: 0.8405 -                 Save Best F1-score: 0.8404 Model
Number of bad epochs 0
Current learning rate: 0.010625
Epoch 15 - avg_train_loss: 0.1194             avg_val_loss: 0.7241  time: 106s
Epoch 15 - Accuracy: 0.8274298668177954 - F1-score 0.8227845921050903
Number of bad epochs 1
Current learning rate: 0.01
Epoch 16 - avg_train_loss: 0.1148             avg_val_loss: 0.6973  time: 106s
Epoch 16 - Accuracy: 0.8206290733918957 - F1-score 0.8205770405204514
Number of bad epochs 2
Current learning rate: 0.0103125
Epoch 17 - avg_train_loss: 0.1077             avg_val_loss: 0.6838  time: 106s
Epoch 17 - Accuracy: 0.83593085860017 - F1-score 0.8344835584462256
Number of bad epochs 3
Current learning rate: 0.010625
Epoch 18 - avg_train_loss: 0.1012             avg_val_loss: 0.6419  time: 106s
Epoch 18 - Accuracy: 0.8398979880986115 - F1-score 0.8392013583575327
Number of bad epochs 4
Current learning rate: 0.0103125
Epoch 19 - avg_train_loss: 0.0971             avg_val_loss: 0.6521  time: 106s
Epoch 19 - Accuracy: 0.8345140266364409 - F1-score 0.8342978867303654
Number of bad epochs 5
Current learning rate: 0.01
Epoch 20 - avg_train_loss: 0.0952             avg_val_loss: 0.6693  time: 106s
Epoch 20 - Accuracy: 0.8381977897421365 - F1-score 0.8370812138829743
Number of bad epochs 6
Current learning rate: 0.01015625
Epoch 21 - avg_train_loss: 0.0842             avg_val_loss: 0.7125  time: 106s
Epoch 21 - Accuracy: 0.8384811561348824 - F1-score 0.836696197436235
Number of bad epochs 7
Current learning rate: 0.0103125
Epoch 22 - avg_train_loss: 0.0845             avg_val_loss: 0.7057  time: 106s
Epoch 22 - Accuracy: 0.8384811561348824 - F1-score 0.8371291784097845
Number of bad epochs 8
Current learning rate: 0.01015625
Epoch 23 - avg_train_loss: 0.0854             avg_val_loss: 0.6757  time: 105s
Epoch 23 - Accuracy: 0.837631056956645 - F1-score 0.8365442915929545
Number of bad epochs 9
Current learning rate: 0.01
Epoch 24 - avg_train_loss: 0.0798             avg_val_loss: 0.6658  time: 106s
Epoch 24 - Accuracy: 0.8441484839897988 - F1-score 0.8416909809948212
Epoch 24 - Save Best Accuracy: 0.8441 -                 Save Best F1-score: 0.8417 Model
Number of bad epochs 0
Current learning rate: 0.010078125
Epoch 25 - avg_train_loss: 0.0747             avg_val_loss: 0.7219  time: 106s
Epoch 25 - Accuracy: 0.8435817512043071 - F1-score 0.8411086931963686
Number of bad epochs 1
Current learning rate: 0.01015625
Epoch 26 - avg_train_loss: 0.0689             avg_val_loss: 0.8048  time: 106s
Epoch 26 - Accuracy: 0.8393312553131199 - F1-score 0.8383094605322595
Number of bad epochs 2
Current learning rate: 0.010078125
Epoch 27 - avg_train_loss: 0.0664             avg_val_loss: 0.7728  time: 105s
Epoch 27 - Accuracy: 0.8387645225276282 - F1-score 0.8378894484562319
Number of bad epochs 3
Current learning rate: 0.01
Epoch 28 - avg_train_loss: 0.0685             avg_val_loss: 0.7773  time: 106s
Epoch 28 - Accuracy: 0.8362142249929159 - F1-score 0.834186516285112
Number of bad epochs 4
Current learning rate: 0.0100390625
Epoch 29 - avg_train_loss: 0.0661             avg_val_loss: 0.8150  time: 106s
Epoch 29 - Accuracy: 0.8387645225276282 - F1-score 0.8375089807644021
Number of bad epochs 5
Current learning rate: 0.010078125
Epoch 30 - avg_train_loss: 0.0645             avg_val_loss: 0.7627  time: 106s
Epoch 30 - Accuracy: 0.8316803627089827 - F1-score 0.8319236770816948
Number of bad epochs 6
Current learning rate: 0.0100390625
Epoch 31 - avg_train_loss: 0.0609             avg_val_loss: 0.7669  time: 106s
Epoch 31 - Accuracy: 0.8396146217058656 - F1-score 0.8385896771392571
Number of bad epochs 7
Current learning rate: 0.01
Epoch 32 - avg_train_loss: 0.0611             avg_val_loss: 0.7772  time: 106s
Epoch 32 - Accuracy: 0.8364975913856617 - F1-score 0.835694791795067
Number of bad epochs 8
Current learning rate: 0.01001953125
Epoch 33 - avg_train_loss: 0.0583             avg_val_loss: 0.7847  time: 106s
Epoch 33 - Accuracy: 0.8319637291017286 - F1-score 0.8313231485704773
Number of bad epochs 9
Current learning rate: 0.0100390625
Epoch 34 - avg_train_loss: 0.0563             avg_val_loss: 0.8238  time: 106s
Epoch 34 - Accuracy: 0.83593085860017 - F1-score 0.8367120745733417
Number of bad epochs 10
Current learning rate: 0.01001953125
Epoch 35 - avg_train_loss: 0.0556             avg_val_loss: 0.8012  time: 106s
Epoch 35 - Accuracy: 0.8302635307452536 - F1-score 0.8298809402097734
Number of bad epochs 11
Stop the training, since the score has not improved for 10 epochs!
AFTER TRAINING: Epoch 24: Best Accuracy: 0.8441 -                 Best F1-score: 0.8417
