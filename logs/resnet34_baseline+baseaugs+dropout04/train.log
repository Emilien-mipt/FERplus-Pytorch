Reading data...
train shape:
(28217, 2)
valid shape:
(3529, 2)
train fold:
label
0    10295
1     7526
2     3557
3     3530
4     2463
5      191
6      655
dtype: int64
validation fold:
label
0    1329
1     899
2     458
3     415
4     325
5      32
6      71
dtype: int64
Batch size 32
Input size 48
Select CrossEntropyLoss criterion
Enabling mixed precision for training...
Current learning rate: 0.001
Epoch 1 - avg_train_loss: 1.0993             avg_val_loss: 1.1872  time: 29s
Epoch 1 - Accuracy: 0.5412298101445169 - F1-score 0.5553636017041648
Epoch 1 - Save Best Accuracy: 0.5412 -                 Save Best F1-score: 0.5554 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 2 - avg_train_loss: 0.8839             avg_val_loss: 0.7728  time: 29s
Epoch 2 - Accuracy: 0.7251345990365543 - F1-score 0.7128899057645103
Epoch 2 - Save Best Accuracy: 0.7251 -                 Save Best F1-score: 0.7129 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 3 - avg_train_loss: 0.8184             avg_val_loss: 0.7372  time: 29s
Epoch 3 - Accuracy: 0.7432700481722868 - F1-score 0.7280622692827878
Epoch 3 - Save Best Accuracy: 0.7433 -                 Save Best F1-score: 0.7281 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 4 - avg_train_loss: 0.7558             avg_val_loss: 0.7218  time: 30s
Epoch 4 - Accuracy: 0.7441201473505242 - F1-score 0.7248643351029401
Number of bad epochs 1
Current learning rate: 0.001
Epoch 5 - avg_train_loss: 0.7394             avg_val_loss: 0.7117  time: 29s
Epoch 5 - Accuracy: 0.7483706432417115 - F1-score 0.7243630725593485
Number of bad epochs 2
Current learning rate: 0.001
Epoch 6 - avg_train_loss: 0.7175             avg_val_loss: 0.6573  time: 29s
Epoch 6 - Accuracy: 0.7648058940209691 - F1-score 0.7504450724511538
Epoch 6 - Save Best Accuracy: 0.7648 -                 Save Best F1-score: 0.7504 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 7 - avg_train_loss: 0.6714             avg_val_loss: 0.6212  time: 29s
Epoch 7 - Accuracy: 0.7741569849815811 - F1-score 0.7712546340098684
Epoch 7 - Save Best Accuracy: 0.7742 -                 Save Best F1-score: 0.7713 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 8 - avg_train_loss: 0.6444             avg_val_loss: 0.6323  time: 29s
Epoch 8 - Accuracy: 0.7707565882686314 - F1-score 0.7601899544932611
Number of bad epochs 1
Current learning rate: 0.001
Epoch 9 - avg_train_loss: 0.6348             avg_val_loss: 0.7354  time: 30s
Epoch 9 - Accuracy: 0.7361858883536413 - F1-score 0.7307923368269572
Number of bad epochs 2
Current learning rate: 0.001
Epoch 10 - avg_train_loss: 0.6292             avg_val_loss: 0.6027  time: 29s
Epoch 10 - Accuracy: 0.7764239161235478 - F1-score 0.7745918687727308
Epoch 10 - Save Best Accuracy: 0.7764 -                 Save Best F1-score: 0.7746 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 11 - avg_train_loss: 0.5825             avg_val_loss: 0.5969  time: 29s
Epoch 11 - Accuracy: 0.790308869368093 - F1-score 0.786035052451794
Epoch 11 - Save Best Accuracy: 0.7903 -                 Save Best F1-score: 0.7860 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 12 - avg_train_loss: 0.5718             avg_val_loss: 0.5979  time: 29s
Epoch 12 - Accuracy: 0.7815245111929725 - F1-score 0.775969105878701
Number of bad epochs 1
Current learning rate: 0.001
Epoch 13 - avg_train_loss: 0.5654             avg_val_loss: 0.5767  time: 29s
Epoch 13 - Accuracy: 0.7942759988665344 - F1-score 0.7835309942440783
Number of bad epochs 2
Current learning rate: 0.001
Epoch 14 - avg_train_loss: 0.5522             avg_val_loss: 0.6055  time: 29s
Epoch 14 - Accuracy: 0.7829413431567016 - F1-score 0.7747361890264968
Number of bad epochs 3
Current learning rate: 0.001
Epoch 15 - avg_train_loss: 0.5299             avg_val_loss: 0.5874  time: 29s
Epoch 15 - Accuracy: 0.7894587701898554 - F1-score 0.7861330899404579
Number of bad epochs 4
Current learning rate: 0.001
Epoch 16 - avg_train_loss: 0.5124             avg_val_loss: 0.5667  time: 29s
Epoch 16 - Accuracy: 0.804477189005384 - F1-score 0.7990480437562253
Epoch 16 - Save Best Accuracy: 0.8045 -                 Save Best F1-score: 0.7990 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 17 - avg_train_loss: 0.5103             avg_val_loss: 0.5531  time: 29s
Epoch 17 - Accuracy: 0.796542930008501 - F1-score 0.7939361649144138
Number of bad epochs 1
Current learning rate: 0.001
Epoch 18 - avg_train_loss: 0.4805             avg_val_loss: 0.5542  time: 29s
Epoch 18 - Accuracy: 0.7982431283649759 - F1-score 0.7962883325163352
Number of bad epochs 2
Current learning rate: 0.001
Epoch 19 - avg_train_loss: 0.4687             avg_val_loss: 0.5535  time: 29s
Epoch 19 - Accuracy: 0.8070274865400964 - F1-score 0.8021801695154918
Epoch 19 - Save Best Accuracy: 0.8070 -                 Save Best F1-score: 0.8022 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 20 - avg_train_loss: 0.4813             avg_val_loss: 0.6283  time: 29s
Epoch 20 - Accuracy: 0.7778407480872769 - F1-score 0.7746526956028519
Number of bad epochs 1
Current learning rate: 0.001
Epoch 21 - avg_train_loss: 0.4541             avg_val_loss: 0.5569  time: 29s
Epoch 21 - Accuracy: 0.8002266931141967 - F1-score 0.7960015758625
Number of bad epochs 2
Current learning rate: 0.001
Epoch 22 - avg_train_loss: 0.4445             avg_val_loss: 0.5606  time: 29s
Epoch 22 - Accuracy: 0.8047605553981297 - F1-score 0.801412932521035
Number of bad epochs 3
Current learning rate: 0.001
Epoch 23 - avg_train_loss: 0.4222             avg_val_loss: 0.5812  time: 29s
Epoch 23 - Accuracy: 0.7985264947577217 - F1-score 0.7900901277550578
Number of bad epochs 4
Current learning rate: 0.001
Epoch 24 - avg_train_loss: 0.4281             avg_val_loss: 0.5955  time: 30s
Epoch 24 - Accuracy: 0.7869084726551431 - F1-score 0.784576909859941
Number of bad epochs 5
Current learning rate: 0.001
Epoch 25 - avg_train_loss: 0.4002             avg_val_loss: 0.5744  time: 29s
Epoch 25 - Accuracy: 0.8039104562198923 - F1-score 0.7990032712558803
Number of bad epochs 6
Current learning rate: 0.001
Epoch 26 - avg_train_loss: 0.3862             avg_val_loss: 0.5553  time: 29s
Epoch 26 - Accuracy: 0.8061773873618588 - F1-score 0.8019386553294119
Number of bad epochs 7
Current learning rate: 0.001
Epoch 27 - avg_train_loss: 0.3785             avg_val_loss: 0.6116  time: 30s
Epoch 27 - Accuracy: 0.7988098611504676 - F1-score 0.7989217860696676
Number of bad epochs 8
Current learning rate: 0.001
Epoch 28 - avg_train_loss: 0.3625             avg_val_loss: 0.6280  time: 29s
Epoch 28 - Accuracy: 0.7883253046188722 - F1-score 0.7856193661324955
Number of bad epochs 9
Current learning rate: 0.001
Epoch 29 - avg_train_loss: 0.3585             avg_val_loss: 0.5970  time: 29s
Epoch 29 - Accuracy: 0.8073108529328422 - F1-score 0.8032849685519139
Epoch 29 - Save Best Accuracy: 0.8073 -                 Save Best F1-score: 0.8033 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 30 - avg_train_loss: 0.3562             avg_val_loss: 0.5981  time: 30s
Epoch 30 - Accuracy: 0.7973930291867385 - F1-score 0.794833254364476
Number of bad epochs 1
Current learning rate: 0.001
Epoch 31 - avg_train_loss: 0.3421             avg_val_loss: 0.6329  time: 30s
Epoch 31 - Accuracy: 0.7988098611504676 - F1-score 0.7956280111985488
Number of bad epochs 2
Current learning rate: 0.001
Epoch 32 - avg_train_loss: 0.3348             avg_val_loss: 0.6163  time: 30s
Epoch 32 - Accuracy: 0.804477189005384 - F1-score 0.8019430470510591
Number of bad epochs 3
Current learning rate: 0.001
Epoch 33 - avg_train_loss: 0.3275             avg_val_loss: 0.6489  time: 29s
Epoch 33 - Accuracy: 0.788608671011618 - F1-score 0.7885680083307687
Number of bad epochs 4
Current learning rate: 0.001
Epoch 34 - avg_train_loss: 0.3133             avg_val_loss: 0.6381  time: 30s
Epoch 34 - Accuracy: 0.8016435250779258 - F1-score 0.7995874112602968
Number of bad epochs 5
Current learning rate: 0.001
Epoch 35 - avg_train_loss: 0.3180             avg_val_loss: 0.6336  time: 29s
Epoch 35 - Accuracy: 0.7968262964012468 - F1-score 0.7963991865347344
Number of bad epochs 6
Current learning rate: 0.001
Epoch 36 - avg_train_loss: 0.3084             avg_val_loss: 0.6702  time: 29s
Epoch 36 - Accuracy: 0.7982431283649759 - F1-score 0.7952888823666742
Number of bad epochs 7
Current learning rate: 0.001
Epoch 37 - avg_train_loss: 0.2958             avg_val_loss: 0.7121  time: 29s
Epoch 37 - Accuracy: 0.8005100595069424 - F1-score 0.79638465971676
Number of bad epochs 8
Current learning rate: 0.001
Epoch 38 - avg_train_loss: 0.3179             avg_val_loss: 0.6627  time: 30s
Epoch 38 - Accuracy: 0.8010767922924341 - F1-score 0.7992798524951152
Number of bad epochs 9
Current learning rate: 0.001
Epoch 39 - avg_train_loss: 0.2767             avg_val_loss: 0.6662  time: 29s
Epoch 39 - Accuracy: 0.80136015868518 - F1-score 0.7974061239035697
Number of bad epochs 10
Current learning rate: 0.001
Epoch 40 - avg_train_loss: 0.2765             avg_val_loss: 0.6366  time: 29s
Epoch 40 - Accuracy: 0.8047605553981297 - F1-score 0.80300687025477
Number of bad epochs 11
Stop the training, since the score has not improved for 10 epochs!
AFTER TRAINING: Epoch 29: Best Accuracy: 0.8073 -                 Best F1-score: 0.8033
