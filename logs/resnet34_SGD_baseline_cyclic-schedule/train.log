Reading data...
train shape:
(28217, 2)
valid shape:
(3529, 2)
train fold:
label
0    10295
1     7526
2     3557
3     3530
4     2463
5      191
6      655
dtype: int64
validation fold:
label
0    1329
1     899
2     458
3     415
4     325
5      32
6      71
dtype: int64
Batch size 32
Input size 224
Select CrossEntropyLoss criterion
Enabling mixed precision for training...
Current learning rate: 0.015
Epoch 1 - avg_train_loss: 0.8473             avg_val_loss: 0.5814  time: 76s
Epoch 1 - Accuracy: 0.7897421365826013 - F1-score 0.7807496523627436
Epoch 1 - Save Best Accuracy: 0.7897 -                 Save Best F1-score: 0.7807 Model
Number of bad epochs 0
Current learning rate: 0.02
Epoch 2 - avg_train_loss: 0.5854             avg_val_loss: 0.5336  time: 76s
Epoch 2 - Accuracy: 0.8041938226126382 - F1-score 0.7991582301912553
Epoch 2 - Save Best Accuracy: 0.8042 -                 Save Best F1-score: 0.7992 Model
Number of bad epochs 0
Current learning rate: 0.015
Epoch 3 - avg_train_loss: 0.4978             avg_val_loss: 0.4764  time: 76s
Epoch 3 - Accuracy: 0.8228960045338622 - F1-score 0.8154887913699406
Epoch 3 - Save Best Accuracy: 0.8229 -                 Save Best F1-score: 0.8155 Model
Number of bad epochs 0
Current learning rate: 0.01
Epoch 4 - avg_train_loss: 0.4388             avg_val_loss: 0.4625  time: 77s
Epoch 4 - Accuracy: 0.8268631340323037 - F1-score 0.8202267129043156
Epoch 4 - Save Best Accuracy: 0.8269 -                 Save Best F1-score: 0.8202 Model
Number of bad epochs 0
Current learning rate: 0.0125
Epoch 5 - avg_train_loss: 0.4040             avg_val_loss: 0.5663  time: 76s
Epoch 5 - Accuracy: 0.7911589685463304 - F1-score 0.7873803353263373
Number of bad epochs 1
Current learning rate: 0.015
Epoch 6 - avg_train_loss: 0.3638             avg_val_loss: 0.4524  time: 77s
Epoch 6 - Accuracy: 0.8268631340323037 - F1-score 0.826063461818014
Epoch 6 - Save Best Accuracy: 0.8269 -                 Save Best F1-score: 0.8261 Model
Number of bad epochs 0
Current learning rate: 0.0125
Epoch 7 - avg_train_loss: 0.3318             avg_val_loss: 0.4276  time: 76s
Epoch 7 - Accuracy: 0.8401813544913573 - F1-score 0.8393929374770279
Epoch 7 - Save Best Accuracy: 0.8402 -                 Save Best F1-score: 0.8394 Model
Number of bad epochs 0
Current learning rate: 0.01
Epoch 8 - avg_train_loss: 0.3142             avg_val_loss: 0.4951  time: 76s
Epoch 8 - Accuracy: 0.8172286766789458 - F1-score 0.8177981172321522
Number of bad epochs 1
Current learning rate: 0.01125
Epoch 9 - avg_train_loss: 0.2875             avg_val_loss: 0.4658  time: 77s
Epoch 9 - Accuracy: 0.8333805610654577 - F1-score 0.8321889135586955
Number of bad epochs 2
Current learning rate: 0.0125
Epoch 10 - avg_train_loss: 0.2681             avg_val_loss: 0.4822  time: 76s
Epoch 10 - Accuracy: 0.8243128364975914 - F1-score 0.8249589208490584
Number of bad epochs 3
Current learning rate: 0.01125
Epoch 11 - avg_train_loss: 0.2423             avg_val_loss: 0.5274  time: 77s
Epoch 11 - Accuracy: 0.8243128364975914 - F1-score 0.8230384598960582
Number of bad epochs 4
Current learning rate: 0.01
Epoch 12 - avg_train_loss: 0.2227             avg_val_loss: 0.5513  time: 77s
Epoch 12 - Accuracy: 0.8288466987815245 - F1-score 0.830683625638348
Number of bad epochs 5
Current learning rate: 0.010625
Epoch 13 - avg_train_loss: 0.2205             avg_val_loss: 0.5253  time: 76s
Epoch 13 - Accuracy: 0.8325304618872201 - F1-score 0.8280541220108335
Number of bad epochs 6
Current learning rate: 0.01125
Epoch 14 - avg_train_loss: 0.2042             avg_val_loss: 0.4989  time: 77s
Epoch 14 - Accuracy: 0.8390478889203741 - F1-score 0.8368633237936023
Number of bad epochs 7
Current learning rate: 0.010625
Epoch 15 - avg_train_loss: 0.1887             avg_val_loss: 0.5268  time: 77s
Epoch 15 - Accuracy: 0.8345140266364409 - F1-score 0.8334873215809826
Number of bad epochs 8
Current learning rate: 0.01
Epoch 16 - avg_train_loss: 0.1796             avg_val_loss: 0.5531  time: 77s
Epoch 16 - Accuracy: 0.8384811561348824 - F1-score 0.8387866176367098
Number of bad epochs 9
Current learning rate: 0.0103125
Epoch 17 - avg_train_loss: 0.1734             avg_val_loss: 0.5017  time: 77s
Epoch 17 - Accuracy: 0.8444318503825446 - F1-score 0.843448253735035
Epoch 17 - Save Best Accuracy: 0.8444 -                 Save Best F1-score: 0.8434 Model
Number of bad epochs 0
Current learning rate: 0.010625
Epoch 18 - avg_train_loss: 0.1602             avg_val_loss: 0.5467  time: 76s
Epoch 18 - Accuracy: 0.8342306602436951 - F1-score 0.8360684150545198
Number of bad epochs 1
Current learning rate: 0.0103125
Epoch 19 - avg_train_loss: 0.1508             avg_val_loss: 0.5683  time: 77s
Epoch 19 - Accuracy: 0.8430150184188155 - F1-score 0.8409889302341694
Number of bad epochs 2
Current learning rate: 0.01
Epoch 20 - avg_train_loss: 0.1483             avg_val_loss: 0.5750  time: 77s
Epoch 20 - Accuracy: 0.8415981864550864 - F1-score 0.8406300165336512
Number of bad epochs 3
Current learning rate: 0.01015625
Epoch 21 - avg_train_loss: 0.1382             avg_val_loss: 0.5985  time: 77s
Epoch 21 - Accuracy: 0.8413148200623406 - F1-score 0.8385536727686443
Number of bad epochs 4
Current learning rate: 0.0103125
Epoch 22 - avg_train_loss: 0.1371             avg_val_loss: 0.6156  time: 77s
Epoch 22 - Accuracy: 0.8404647208841032 - F1-score 0.8382338824389773
Number of bad epochs 5
Current learning rate: 0.01015625
Epoch 23 - avg_train_loss: 0.1306             avg_val_loss: 0.5947  time: 77s
Epoch 23 - Accuracy: 0.8356474922074242 - F1-score 0.8346465710046342
Number of bad epochs 6
Current learning rate: 0.01
Epoch 24 - avg_train_loss: 0.1196             avg_val_loss: 0.5853  time: 77s
Epoch 24 - Accuracy: 0.8432983848115614 - F1-score 0.8416779378147696
Number of bad epochs 7
Current learning rate: 0.010078125
Epoch 25 - avg_train_loss: 0.1189             avg_val_loss: 0.6059  time: 77s
Epoch 25 - Accuracy: 0.8398979880986115 - F1-score 0.8396038512213008
Number of bad epochs 8
Current learning rate: 0.01015625
Epoch 26 - avg_train_loss: 0.1104             avg_val_loss: 0.5706  time: 77s
Epoch 26 - Accuracy: 0.8458486823462738 - F1-score 0.8449486635912223
Epoch 26 - Save Best Accuracy: 0.8458 -                 Save Best F1-score: 0.8449 Model
Number of bad epochs 0
Current learning rate: 0.010078125
Epoch 27 - avg_train_loss: 0.1044             avg_val_loss: 0.6404  time: 77s
Epoch 27 - Accuracy: 0.8381977897421365 - F1-score 0.8367365891008913
Number of bad epochs 1
Current learning rate: 0.01
Epoch 28 - avg_train_loss: 0.1025             avg_val_loss: 0.6562  time: 77s
Epoch 28 - Accuracy: 0.8370643241711533 - F1-score 0.8347405758252614
Number of bad epochs 2
Current learning rate: 0.0100390625
Epoch 29 - avg_train_loss: 0.1020             avg_val_loss: 0.6498  time: 76s
Epoch 29 - Accuracy: 0.8347973930291868 - F1-score 0.8346518865040365
Number of bad epochs 3
Current learning rate: 0.010078125
Epoch 30 - avg_train_loss: 0.0975             avg_val_loss: 0.6548  time: 76s
Epoch 30 - Accuracy: 0.8370643241711533 - F1-score 0.8356395750416242
Number of bad epochs 4
Current learning rate: 0.0100390625
Epoch 31 - avg_train_loss: 0.0924             avg_val_loss: 0.6527  time: 77s
Epoch 31 - Accuracy: 0.8390478889203741 - F1-score 0.8397896543987095
Number of bad epochs 5
Current learning rate: 0.01
Epoch 32 - avg_train_loss: 0.0936             avg_val_loss: 0.6430  time: 76s
Epoch 32 - Accuracy: 0.8319637291017286 - F1-score 0.8339773428853877
Number of bad epochs 6
Current learning rate: 0.01001953125
Epoch 33 - avg_train_loss: 0.0914             avg_val_loss: 0.6318  time: 77s
Epoch 33 - Accuracy: 0.8418815528478323 - F1-score 0.8386052460759013
Number of bad epochs 7
Current learning rate: 0.0100390625
Epoch 34 - avg_train_loss: 0.0859             avg_val_loss: 0.6425  time: 77s
Epoch 34 - Accuracy: 0.8373476905638991 - F1-score 0.8367700913281455
Number of bad epochs 8
Current learning rate: 0.01001953125
Epoch 35 - avg_train_loss: 0.0809             avg_val_loss: 0.6907  time: 77s
Epoch 35 - Accuracy: 0.8430150184188155 - F1-score 0.8433868708796212
Number of bad epochs 9
Current learning rate: 0.01
Epoch 36 - avg_train_loss: 0.0802             avg_val_loss: 0.7872  time: 76s
Epoch 36 - Accuracy: 0.8427316520260697 - F1-score 0.8401086597135774
Number of bad epochs 10
Current learning rate: 0.010009765625
Epoch 37 - avg_train_loss: 0.0771             avg_val_loss: 0.6731  time: 77s
Epoch 37 - Accuracy: 0.8404647208841032 - F1-score 0.838044001419346
Number of bad epochs 11
Stop the training, since the score has not improved for 10 epochs!
AFTER TRAINING: Epoch 26: Best Accuracy: 0.8458 -                 Best F1-score: 0.8449
