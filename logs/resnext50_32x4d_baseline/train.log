Reading data...
train shape:
(28217, 2)
valid shape:
(3529, 2)
train fold:
label
0    10295
1     7526
2     3557
3     3530
4     2463
5      191
6      655
dtype: int64
validation fold:
label
0    1329
1     899
2     458
3     415
4     325
5      32
6      71
dtype: int64
Batch size 32
Input size 48
Select CrossEntropyLoss criterion
Enabling mixed precision for training...
Current learning rate: 0.001
Epoch 1 - avg_train_loss: 0.9497             avg_val_loss: 0.8324  time: 37s
Epoch 1 - Accuracy: 0.6996316236894304 - F1-score 0.692085115295405
Epoch 1 - Save Best Accuracy: 0.6996 -                 Save Best F1-score: 0.6921 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 2 - avg_train_loss: 0.7101             avg_val_loss: 0.7175  time: 37s
Epoch 2 - Accuracy: 0.7376027203173704 - F1-score 0.7233769123103647
Epoch 2 - Save Best Accuracy: 0.7376 -                 Save Best F1-score: 0.7234 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 3 - avg_train_loss: 0.6199             avg_val_loss: 0.6455  time: 38s
Epoch 3 - Accuracy: 0.7801076792292434 - F1-score 0.7692280763761092
Epoch 3 - Save Best Accuracy: 0.7801 -                 Save Best F1-score: 0.7692 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 4 - avg_train_loss: 0.5416             avg_val_loss: 0.6400  time: 37s
Epoch 4 - Accuracy: 0.7701898554831397 - F1-score 0.7468232918149266
Number of bad epochs 1
Current learning rate: 0.001
Epoch 5 - avg_train_loss: 0.4794             avg_val_loss: 0.6098  time: 37s
Epoch 5 - Accuracy: 0.7880419382261263 - F1-score 0.7829268820133988
Epoch 5 - Save Best Accuracy: 0.7880 -                 Save Best F1-score: 0.7829 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 6 - avg_train_loss: 0.4153             avg_val_loss: 0.6547  time: 37s
Epoch 6 - Accuracy: 0.772740153017852 - F1-score 0.7708119506762504
Number of bad epochs 1
Current learning rate: 0.001
Epoch 7 - avg_train_loss: 0.3571             avg_val_loss: 0.6517  time: 37s
Epoch 7 - Accuracy: 0.7852082742986681 - F1-score 0.7848475814651601
Number of bad epochs 2
Current learning rate: 0.001
Epoch 8 - avg_train_loss: 0.3008             avg_val_loss: 0.7008  time: 37s
Epoch 8 - Accuracy: 0.7750070841598187 - F1-score 0.7737426345043695
Number of bad epochs 3
Current learning rate: 0.001
Epoch 9 - avg_train_loss: 0.3484             avg_val_loss: 0.6771  time: 38s
Epoch 9 - Accuracy: 0.7684896571266647 - F1-score 0.762752178591648
Number of bad epochs 4
Current learning rate: 0.001
Epoch 10 - avg_train_loss: 0.2536             avg_val_loss: 0.7067  time: 37s
Epoch 10 - Accuracy: 0.7880419382261263 - F1-score 0.7839979849591875
Number of bad epochs 5
Current learning rate: 0.001
Epoch 11 - avg_train_loss: 0.1791             avg_val_loss: 0.7945  time: 37s
Epoch 11 - Accuracy: 0.7942759988665344 - F1-score 0.789157932298797
Epoch 11 - Save Best Accuracy: 0.7943 -                 Save Best F1-score: 0.7892 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 12 - avg_train_loss: 0.1724             avg_val_loss: 0.8926  time: 37s
Epoch 12 - Accuracy: 0.7733068858033437 - F1-score 0.768173932987265
Number of bad epochs 1
Current learning rate: 0.001
Epoch 13 - avg_train_loss: 0.1604             avg_val_loss: 0.8714  time: 37s
Epoch 13 - Accuracy: 0.7869084726551431 - F1-score 0.7843104695261419
Number of bad epochs 2
Current learning rate: 0.001
Epoch 14 - avg_train_loss: 0.1393             avg_val_loss: 0.8775  time: 37s
Epoch 14 - Accuracy: 0.7888920374043639 - F1-score 0.7865403772250475
Number of bad epochs 3
Current learning rate: 0.001
Epoch 15 - avg_train_loss: 0.1752             avg_val_loss: 0.7978  time: 37s
Epoch 15 - Accuracy: 0.7956928308302635 - F1-score 0.7918786217216895
Epoch 15 - Save Best Accuracy: 0.7957 -                 Save Best F1-score: 0.7919 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 16 - avg_train_loss: 0.1227             avg_val_loss: 0.8534  time: 37s
Epoch 16 - Accuracy: 0.7956928308302635 - F1-score 0.7926333880554249
Epoch 16 - Save Best Accuracy: 0.7957 -                 Save Best F1-score: 0.7926 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 17 - avg_train_loss: 0.1063             avg_val_loss: 0.9191  time: 37s
Epoch 17 - Accuracy: 0.7803910456219892 - F1-score 0.7805107664567892
Number of bad epochs 1
Current learning rate: 0.001
Epoch 18 - avg_train_loss: 0.1029             avg_val_loss: 0.9587  time: 37s
Epoch 18 - Accuracy: 0.7911589685463304 - F1-score 0.787477321330772
Number of bad epochs 2
Current learning rate: 0.001
Epoch 19 - avg_train_loss: 0.1021             avg_val_loss: 1.0319  time: 37s
Epoch 19 - Accuracy: 0.7840748087276849 - F1-score 0.7836194710829628
Number of bad epochs 3
Current learning rate: 0.001
Epoch 20 - avg_train_loss: 0.1028             avg_val_loss: 0.9811  time: 37s
Epoch 20 - Accuracy: 0.7772740153017852 - F1-score 0.7775667946326746
Number of bad epochs 4
Current learning rate: 0.001
Epoch 21 - avg_train_loss: 0.1001             avg_val_loss: 1.0152  time: 37s
Epoch 21 - Accuracy: 0.7871918390478889 - F1-score 0.7845207394664246
Number of bad epochs 5
Current learning rate: 0.001
Epoch 22 - avg_train_loss: 0.0894             avg_val_loss: 1.0163  time: 38s
Epoch 22 - Accuracy: 0.7846415415131766 - F1-score 0.7828107345273037
Number of bad epochs 6
Current learning rate: 0.001
Epoch 23 - avg_train_loss: 0.0836             avg_val_loss: 1.0983  time: 37s
Epoch 23 - Accuracy: 0.7874752054406348 - F1-score 0.7860210270214105
Number of bad epochs 7
Current learning rate: 0.001
Epoch 24 - avg_train_loss: 0.0871             avg_val_loss: 1.2070  time: 37s
Epoch 24 - Accuracy: 0.7786908472655143 - F1-score 0.7707819371121659
Number of bad epochs 8
Current learning rate: 0.001
Epoch 25 - avg_train_loss: 0.1040             avg_val_loss: 0.9294  time: 37s
Epoch 25 - Accuracy: 0.7990932275432133 - F1-score 0.7960405519090059
Epoch 25 - Save Best Accuracy: 0.7991 -                 Save Best F1-score: 0.7960 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 26 - avg_train_loss: 0.0720             avg_val_loss: 1.0904  time: 37s
Epoch 26 - Accuracy: 0.7789742136582601 - F1-score 0.7800758160245679
Number of bad epochs 1
Current learning rate: 0.001
Epoch 27 - avg_train_loss: 0.0640             avg_val_loss: 1.0854  time: 37s
Epoch 27 - Accuracy: 0.7832247095494475 - F1-score 0.7853585411520102
Number of bad epochs 2
Current learning rate: 0.001
Epoch 28 - avg_train_loss: 0.0881             avg_val_loss: 1.0065  time: 37s
Epoch 28 - Accuracy: 0.777557381694531 - F1-score 0.7737758773537948
Number of bad epochs 3
Current learning rate: 0.001
Epoch 29 - avg_train_loss: 0.0696             avg_val_loss: 1.1578  time: 37s
Epoch 29 - Accuracy: 0.7812411448002267 - F1-score 0.7785390843427342
Number of bad epochs 4
Current learning rate: 0.001
Epoch 30 - avg_train_loss: 0.0628             avg_val_loss: 1.2457  time: 37s
Epoch 30 - Accuracy: 0.7897421365826013 - F1-score 0.785066507174172
Number of bad epochs 5
Current learning rate: 0.001
Epoch 31 - avg_train_loss: 0.0729             avg_val_loss: 1.0783  time: 37s
Epoch 31 - Accuracy: 0.7826579767639558 - F1-score 0.7815412964330325
Number of bad epochs 6
Current learning rate: 0.001
Epoch 32 - avg_train_loss: 0.0634             avg_val_loss: 1.1987  time: 37s
Epoch 32 - Accuracy: 0.7809577784074808 - F1-score 0.7779086023700378
Number of bad epochs 7
Current learning rate: 0.001
Epoch 33 - avg_train_loss: 0.0560             avg_val_loss: 1.2298  time: 37s
Epoch 33 - Accuracy: 0.7730235194105979 - F1-score 0.772727727988651
Number of bad epochs 8
Current learning rate: 0.001
Epoch 34 - avg_train_loss: 0.0596             avg_val_loss: 1.2501  time: 37s
Epoch 34 - Accuracy: 0.7713233210541229 - F1-score 0.7671707293244069
Number of bad epochs 9
Current learning rate: 0.001
Epoch 35 - avg_train_loss: 0.0601             avg_val_loss: 1.1788  time: 38s
Epoch 35 - Accuracy: 0.7679229243411732 - F1-score 0.7691407302670037
Number of bad epochs 10
Current learning rate: 0.001
Epoch 36 - avg_train_loss: 0.0587             avg_val_loss: 1.2501  time: 38s
Epoch 36 - Accuracy: 0.7778407480872769 - F1-score 0.7764268931848768
Number of bad epochs 11
Stop the training, since the score has not improved for 10 epochs!
AFTER TRAINING: Epoch 25: Best Accuracy: 0.7991 -                 Best F1-score: 0.7960
