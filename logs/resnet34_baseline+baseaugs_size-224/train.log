Reading data...
train shape:
(28217, 2)
valid shape:
(3529, 2)
train fold:
label
0    10295
1     7526
2     3557
3     3530
4     2463
5      191
6      655
dtype: int64
validation fold:
label
0    1329
1     899
2     458
3     415
4     325
5      32
6      71
dtype: int64
Batch size 32
Input size 224
Select CrossEntropyLoss criterion
Enabling mixed precision for training...
Current learning rate: 0.001
Epoch 1 - avg_train_loss: 0.9264             avg_val_loss: 0.7157  time: 80s
Epoch 1 - Accuracy: 0.7333522244261831 - F1-score 0.7270817148053368
Epoch 1 - Save Best Accuracy: 0.7334 -                 Save Best F1-score: 0.7271 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 2 - avg_train_loss: 0.6843             avg_val_loss: 0.5829  time: 80s
Epoch 2 - Accuracy: 0.7818078775857183 - F1-score 0.7742170460415506
Epoch 2 - Save Best Accuracy: 0.7818 -                 Save Best F1-score: 0.7742 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 3 - avg_train_loss: 0.6023             avg_val_loss: 0.5501  time: 79s
Epoch 3 - Accuracy: 0.7942759988665344 - F1-score 0.7848075390251791
Epoch 3 - Save Best Accuracy: 0.7943 -                 Save Best F1-score: 0.7848 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 4 - avg_train_loss: 0.5493             avg_val_loss: 0.5762  time: 80s
Epoch 4 - Accuracy: 0.7883253046188722 - F1-score 0.778613962487612
Number of bad epochs 1
Current learning rate: 0.001
Epoch 5 - avg_train_loss: 0.5177             avg_val_loss: 0.5355  time: 80s
Epoch 5 - Accuracy: 0.7959761972230094 - F1-score 0.789725910375841
Epoch 5 - Save Best Accuracy: 0.7960 -                 Save Best F1-score: 0.7897 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 6 - avg_train_loss: 0.4793             avg_val_loss: 0.4885  time: 80s
Epoch 6 - Accuracy: 0.8160952111079626 - F1-score 0.8114095083590483
Epoch 6 - Save Best Accuracy: 0.8161 -                 Save Best F1-score: 0.8114 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 7 - avg_train_loss: 0.4492             avg_val_loss: 0.4789  time: 79s
Epoch 7 - Accuracy: 0.8211958061773874 - F1-score 0.820363311221857
Epoch 7 - Save Best Accuracy: 0.8212 -                 Save Best F1-score: 0.8204 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 8 - avg_train_loss: 0.4211             avg_val_loss: 0.4869  time: 80s
Epoch 8 - Accuracy: 0.8152451119297252 - F1-score 0.8165482332124592
Number of bad epochs 1
Current learning rate: 0.001
Epoch 9 - avg_train_loss: 0.3975             avg_val_loss: 0.4694  time: 80s
Epoch 9 - Accuracy: 0.8172286766789458 - F1-score 0.8154598192171958
Number of bad epochs 2
Current learning rate: 0.001
Epoch 10 - avg_train_loss: 0.3718             avg_val_loss: 0.4668  time: 80s
Epoch 10 - Accuracy: 0.8282799659960328 - F1-score 0.8270817200570391
Epoch 10 - Save Best Accuracy: 0.8283 -                 Save Best F1-score: 0.8271 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 11 - avg_train_loss: 0.3425             avg_val_loss: 0.4600  time: 80s
Epoch 11 - Accuracy: 0.8291300651742703 - F1-score 0.825807718441408
Number of bad epochs 1
Current learning rate: 0.001
Epoch 12 - avg_train_loss: 0.3185             avg_val_loss: 0.4960  time: 80s
Epoch 12 - Accuracy: 0.826579767639558 - F1-score 0.8266031734658046
Number of bad epochs 2
Current learning rate: 0.001
Epoch 13 - avg_train_loss: 0.3048             avg_val_loss: 0.5210  time: 80s
Epoch 13 - Accuracy: 0.8234627373193539 - F1-score 0.8195391777852469
Number of bad epochs 3
Current learning rate: 0.001
Epoch 14 - avg_train_loss: 0.2845             avg_val_loss: 0.4743  time: 80s
Epoch 14 - Accuracy: 0.832813828279966 - F1-score 0.8315314048579008
Epoch 14 - Save Best Accuracy: 0.8328 -                 Save Best F1-score: 0.8315 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 15 - avg_train_loss: 0.2670             avg_val_loss: 0.4882  time: 79s
Epoch 15 - Accuracy: 0.8336639274582035 - F1-score 0.8329703149098034
Epoch 15 - Save Best Accuracy: 0.8337 -                 Save Best F1-score: 0.8330 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 16 - avg_train_loss: 0.2449             avg_val_loss: 0.5045  time: 80s
Epoch 16 - Accuracy: 0.8370643241711533 - F1-score 0.8332078685874766
Epoch 16 - Save Best Accuracy: 0.8371 -                 Save Best F1-score: 0.8332 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 17 - avg_train_loss: 0.2353             avg_val_loss: 0.5145  time: 80s
Epoch 17 - Accuracy: 0.8294134315670162 - F1-score 0.8282932070532806
Number of bad epochs 1
Current learning rate: 0.001
Epoch 18 - avg_train_loss: 0.2191             avg_val_loss: 0.5243  time: 80s
Epoch 18 - Accuracy: 0.8325304618872201 - F1-score 0.8323803710053248
Number of bad epochs 2
Current learning rate: 0.001
Epoch 19 - avg_train_loss: 0.2145             avg_val_loss: 0.5170  time: 80s
Epoch 19 - Accuracy: 0.8356474922074242 - F1-score 0.8342256042013408
Number of bad epochs 3
Current learning rate: 0.001
Epoch 20 - avg_train_loss: 0.2016             avg_val_loss: 0.5282  time: 80s
Epoch 20 - Accuracy: 0.83593085860017 - F1-score 0.834133794584187
Number of bad epochs 4
Current learning rate: 0.001
Epoch 21 - avg_train_loss: 0.1909             avg_val_loss: 0.5322  time: 80s
Epoch 21 - Accuracy: 0.8350807594219326 - F1-score 0.8317596818621724
Number of bad epochs 5
Current learning rate: 0.001
Epoch 22 - avg_train_loss: 0.1832             avg_val_loss: 0.5520  time: 79s
Epoch 22 - Accuracy: 0.8313969963162369 - F1-score 0.8298094856574306
Number of bad epochs 6
Current learning rate: 0.001
Epoch 23 - avg_train_loss: 0.1770             avg_val_loss: 0.5534  time: 80s
Epoch 23 - Accuracy: 0.8356474922074242 - F1-score 0.8349316953179243
Number of bad epochs 7
Current learning rate: 0.001
Epoch 24 - avg_train_loss: 0.1687             avg_val_loss: 0.5557  time: 80s
Epoch 24 - Accuracy: 0.832813828279966 - F1-score 0.8316373057432804
Number of bad epochs 8
Current learning rate: 0.001
Epoch 25 - avg_train_loss: 0.1629             avg_val_loss: 0.5648  time: 80s
Epoch 25 - Accuracy: 0.8336639274582035 - F1-score 0.8318420048669364
Number of bad epochs 9
Current learning rate: 0.001
Epoch 26 - avg_train_loss: 0.1498             avg_val_loss: 0.5973  time: 80s
Epoch 26 - Accuracy: 0.8325304618872201 - F1-score 0.8302654626603627
Number of bad epochs 10
Current learning rate: 0.001
Epoch 27 - avg_train_loss: 0.1514             avg_val_loss: 0.5892  time: 80s
Epoch 27 - Accuracy: 0.8316803627089827 - F1-score 0.8300740150933694
Number of bad epochs 11
Stop the training, since the score has not improved for 10 epochs!
AFTER TRAINING: Epoch 16: Best Accuracy: 0.8371 -                 Best F1-score: 0.8349
