Reading data...
train shape:
(28217, 2)
valid shape:
(3529, 2)
train fold:
label
0    10295
1     7526
2     3557
3     3530
4     2463
5      191
6      655
dtype: int64
validation fold:
label
0    1329
1     899
2     458
3     415
4     325
5      32
6      71
dtype: int64
Batch size 32
Input size 48
Select CrossEntropyLoss criterion
Enabling mixed precision for training...
Current learning rate: 0.001
Epoch 1 - avg_train_loss: 1.1848             avg_val_loss: 0.9755  time: 32s
Epoch 1 - Accuracy: 0.6724284499858317 - F1-score 0.6246511016643864
Epoch 1 - Save Best Accuracy: 0.6724 -                 Save Best F1-score: 0.6247 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 2 - avg_train_loss: 0.9557             avg_val_loss: 0.8208  time: 31s
Epoch 2 - Accuracy: 0.716066874468688 - F1-score 0.6847052723809443
Epoch 2 - Save Best Accuracy: 0.7161 -                 Save Best F1-score: 0.6847 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 3 - avg_train_loss: 0.8928             avg_val_loss: 0.7795  time: 32s
Epoch 3 - Accuracy: 0.7288183621422499 - F1-score 0.7110971378188239
Epoch 3 - Save Best Accuracy: 0.7288 -                 Save Best F1-score: 0.7111 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 4 - avg_train_loss: 0.8804             avg_val_loss: 0.7259  time: 32s
Epoch 4 - Accuracy: 0.7418532162085577 - F1-score 0.7221368487005273
Epoch 4 - Save Best Accuracy: 0.7419 -                 Save Best F1-score: 0.7221 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 5 - avg_train_loss: 0.8516             avg_val_loss: 0.7391  time: 32s
Epoch 5 - Accuracy: 0.738169453102862 - F1-score 0.709667626348661
Number of bad epochs 1
Current learning rate: 0.001
Epoch 6 - avg_train_loss: 0.7552             avg_val_loss: 0.6791  time: 32s
Epoch 6 - Accuracy: 0.768206290733919 - F1-score 0.7597460137349973
Epoch 6 - Save Best Accuracy: 0.7682 -                 Save Best F1-score: 0.7597 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 7 - avg_train_loss: 0.7091             avg_val_loss: 0.6552  time: 32s
Epoch 7 - Accuracy: 0.7557381694531029 - F1-score 0.7527008461099478
Number of bad epochs 1
Current learning rate: 0.001
Epoch 8 - avg_train_loss: 0.6822             avg_val_loss: 0.6344  time: 32s
Epoch 8 - Accuracy: 0.7806744120147351 - F1-score 0.7667842666374559
Epoch 8 - Save Best Accuracy: 0.7807 -                 Save Best F1-score: 0.7668 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 9 - avg_train_loss: 0.6569             avg_val_loss: 0.6050  time: 31s
Epoch 9 - Accuracy: 0.7874752054406348 - F1-score 0.7790549908895389
Epoch 9 - Save Best Accuracy: 0.7875 -                 Save Best F1-score: 0.7791 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 10 - avg_train_loss: 0.6345             avg_val_loss: 0.6298  time: 32s
Epoch 10 - Accuracy: 0.7809577784074808 - F1-score 0.7753151753845262
Number of bad epochs 1
Current learning rate: 0.001
Epoch 11 - avg_train_loss: 0.6122             avg_val_loss: 0.5896  time: 32s
Epoch 11 - Accuracy: 0.7914423349390762 - F1-score 0.7841670787014104
Epoch 11 - Save Best Accuracy: 0.7914 -                 Save Best F1-score: 0.7842 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 12 - avg_train_loss: 0.5868             avg_val_loss: 0.6217  time: 31s
Epoch 12 - Accuracy: 0.7684896571266647 - F1-score 0.7619355445565877
Number of bad epochs 1
Current learning rate: 0.001
Epoch 13 - avg_train_loss: 0.5673             avg_val_loss: 0.6035  time: 32s
Epoch 13 - Accuracy: 0.7846415415131766 - F1-score 0.7718324381624644
Number of bad epochs 2
Current learning rate: 0.001
Epoch 14 - avg_train_loss: 0.5669             avg_val_loss: 0.6525  time: 32s
Epoch 14 - Accuracy: 0.7710399546613772 - F1-score 0.761514667834084
Number of bad epochs 3
Current learning rate: 0.001
Epoch 15 - avg_train_loss: 0.5420             avg_val_loss: 0.6069  time: 32s
Epoch 15 - Accuracy: 0.7801076792292434 - F1-score 0.7786352049563458
Number of bad epochs 4
Current learning rate: 0.001
Epoch 16 - avg_train_loss: 0.5179             avg_val_loss: 0.5999  time: 32s
Epoch 16 - Accuracy: 0.7922924341173136 - F1-score 0.7902831246049272
Epoch 16 - Save Best Accuracy: 0.7923 -                 Save Best F1-score: 0.7903 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 17 - avg_train_loss: 0.4929             avg_val_loss: 0.5827  time: 32s
Epoch 17 - Accuracy: 0.7968262964012468 - F1-score 0.794056975555079
Epoch 17 - Save Best Accuracy: 0.7968 -                 Save Best F1-score: 0.7941 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 18 - avg_train_loss: 0.4815             avg_val_loss: 0.5758  time: 32s
Epoch 18 - Accuracy: 0.7931425332955512 - F1-score 0.789814798435491
Number of bad epochs 1
Current learning rate: 0.001
Epoch 19 - avg_train_loss: 0.4716             avg_val_loss: 0.5734  time: 31s
Epoch 19 - Accuracy: 0.8007934258996883 - F1-score 0.7986621258089861
Epoch 19 - Save Best Accuracy: 0.8008 -                 Save Best F1-score: 0.7987 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 20 - avg_train_loss: 0.4478             avg_val_loss: 0.6151  time: 32s
Epoch 20 - Accuracy: 0.7968262964012468 - F1-score 0.7934348896555016
Number of bad epochs 1
Current learning rate: 0.001
Epoch 21 - avg_train_loss: 0.4296             avg_val_loss: 0.6097  time: 32s
Epoch 21 - Accuracy: 0.793425899688297 - F1-score 0.7881881441612452
Number of bad epochs 2
Current learning rate: 0.001
Epoch 22 - avg_train_loss: 0.4307             avg_val_loss: 0.6203  time: 32s
Epoch 22 - Accuracy: 0.796542930008501 - F1-score 0.7906265492983843
Number of bad epochs 3
Current learning rate: 0.001
Epoch 23 - avg_train_loss: 0.4347             avg_val_loss: 0.5787  time: 31s
Epoch 23 - Accuracy: 0.7979597619722301 - F1-score 0.7947476194564317
Number of bad epochs 4
Current learning rate: 0.001
Epoch 24 - avg_train_loss: 0.4125             avg_val_loss: 0.6128  time: 32s
Epoch 24 - Accuracy: 0.7971096627939926 - F1-score 0.7953133234121116
Number of bad epochs 5
Current learning rate: 0.001
Epoch 25 - avg_train_loss: 0.4047             avg_val_loss: 0.6154  time: 32s
Epoch 25 - Accuracy: 0.8047605553981297 - F1-score 0.80132774188493
Epoch 25 - Save Best Accuracy: 0.8048 -                 Save Best F1-score: 0.8013 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 26 - avg_train_loss: 0.3767             avg_val_loss: 0.5912  time: 32s
Epoch 26 - Accuracy: 0.8033437234344006 - F1-score 0.7974526974738739
Number of bad epochs 1
Current learning rate: 0.001
Epoch 27 - avg_train_loss: 0.3757             avg_val_loss: 0.6067  time: 32s
Epoch 27 - Accuracy: 0.7999433267214509 - F1-score 0.7970900389057967
Number of bad epochs 2
Current learning rate: 0.001
Epoch 28 - avg_train_loss: 0.3703             avg_val_loss: 0.6728  time: 32s
Epoch 28 - Accuracy: 0.7988098611504676 - F1-score 0.7934005792042976
Number of bad epochs 3
Current learning rate: 0.001
Epoch 29 - avg_train_loss: 0.3532             avg_val_loss: 0.6404  time: 32s
Epoch 29 - Accuracy: 0.8022102578634174 - F1-score 0.8006156331976685
Number of bad epochs 4
Current learning rate: 0.001
Epoch 30 - avg_train_loss: 0.3462             avg_val_loss: 0.6085  time: 32s
Epoch 30 - Accuracy: 0.807594219325588 - F1-score 0.8027540146614035
Epoch 30 - Save Best Accuracy: 0.8076 -                 Save Best F1-score: 0.8028 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 31 - avg_train_loss: 0.3338             avg_val_loss: 0.6514  time: 31s
Epoch 31 - Accuracy: 0.7917257013318221 - F1-score 0.7893716555711104
Number of bad epochs 1
Current learning rate: 0.001
Epoch 32 - avg_train_loss: 0.3314             avg_val_loss: 0.6390  time: 31s
Epoch 32 - Accuracy: 0.8010767922924341 - F1-score 0.7980905755760472
Number of bad epochs 2
Current learning rate: 0.001
Epoch 33 - avg_train_loss: 0.3191             avg_val_loss: 0.6494  time: 32s
Epoch 33 - Accuracy: 0.8019268914706715 - F1-score 0.7990447150234232
Number of bad epochs 3
Current learning rate: 0.001
Epoch 34 - avg_train_loss: 0.3052             avg_val_loss: 0.9346  time: 31s
Epoch 34 - Accuracy: 0.7948427316520261 - F1-score 0.7910634783954953
Number of bad epochs 4
Current learning rate: 0.001
Epoch 35 - avg_train_loss: 0.3469             avg_val_loss: 0.6303  time: 32s
Epoch 35 - Accuracy: 0.8092944176820629 - F1-score 0.8078415503337603
Epoch 35 - Save Best Accuracy: 0.8093 -                 Save Best F1-score: 0.8078 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 36 - avg_train_loss: 0.3300             avg_val_loss: 0.6740  time: 31s
Epoch 36 - Accuracy: 0.8058940209691131 - F1-score 0.8048744743839986
Number of bad epochs 1
Current learning rate: 0.001
Epoch 37 - avg_train_loss: 0.2948             avg_val_loss: 0.7942  time: 31s
Epoch 37 - Accuracy: 0.7871918390478889 - F1-score 0.7817435755260125
Number of bad epochs 2
Current learning rate: 0.001
Epoch 38 - avg_train_loss: 0.3271             avg_val_loss: 0.6873  time: 32s
Epoch 38 - Accuracy: 0.8158118447152167 - F1-score 0.8140243840604846
Epoch 38 - Save Best Accuracy: 0.8158 -                 Save Best F1-score: 0.8140 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 39 - avg_train_loss: 0.3000             avg_val_loss: 0.6628  time: 32s
Epoch 39 - Accuracy: 0.8041938226126382 - F1-score 0.8029872403386754
Number of bad epochs 1
Current learning rate: 0.001
Epoch 40 - avg_train_loss: 0.2752             avg_val_loss: 0.6608  time: 32s
Epoch 40 - Accuracy: 0.804477189005384 - F1-score 0.8037091813130968
Number of bad epochs 2
Current learning rate: 0.001
Epoch 41 - avg_train_loss: 0.2716             avg_val_loss: 0.6964  time: 31s
Epoch 41 - Accuracy: 0.796542930008501 - F1-score 0.7961785458437037
Number of bad epochs 3
Current learning rate: 0.001
Epoch 42 - avg_train_loss: 0.2726             avg_val_loss: 0.6812  time: 32s
Epoch 42 - Accuracy: 0.807594219325588 - F1-score 0.8046669054609452
Number of bad epochs 4
Current learning rate: 0.001
Epoch 43 - avg_train_loss: 0.2540             avg_val_loss: 0.7695  time: 31s
Epoch 43 - Accuracy: 0.8047605553981297 - F1-score 0.8018653908293875
Number of bad epochs 5
Current learning rate: 0.001
Epoch 44 - avg_train_loss: 0.2775             avg_val_loss: 0.7523  time: 32s
Epoch 44 - Accuracy: 0.8092944176820629 - F1-score 0.8051752282928016
Number of bad epochs 6
Current learning rate: 0.001
Epoch 45 - avg_train_loss: 0.2623             avg_val_loss: 0.7193  time: 31s
Epoch 45 - Accuracy: 0.8024936242561632 - F1-score 0.8014068889524488
Number of bad epochs 7
Current learning rate: 0.001
Epoch 46 - avg_train_loss: 0.2528             avg_val_loss: 0.6842  time: 32s
Epoch 46 - Accuracy: 0.8053272881836214 - F1-score 0.8018978866394958
Number of bad epochs 8
Current learning rate: 0.001
Epoch 47 - avg_train_loss: 0.2447             avg_val_loss: 0.8287  time: 32s
Epoch 47 - Accuracy: 0.7939926324737886 - F1-score 0.7928579604204394
Number of bad epochs 9
Current learning rate: 0.001
Epoch 48 - avg_train_loss: 0.2613             avg_val_loss: 0.7269  time: 32s
Epoch 48 - Accuracy: 0.8036270898271465 - F1-score 0.8036581871548644
Number of bad epochs 10
Current learning rate: 0.001
Epoch 49 - avg_train_loss: 0.2313             avg_val_loss: 0.7776  time: 32s
Epoch 49 - Accuracy: 0.80136015868518 - F1-score 0.8017803335249742
Number of bad epochs 11
Stop the training, since the score has not improved for 10 epochs!
AFTER TRAINING: Epoch 38: Best Accuracy: 0.8158 -                 Best F1-score: 0.8140
