Reading data...
train shape:
(28217, 2)
valid shape:
(3529, 2)
train fold:
label
0    10295
1     7526
2     3557
3     3530
4     2463
5      191
6      655
dtype: int64
validation fold:
label
0    1329
1     899
2     458
3     415
4     325
5      32
6      71
dtype: int64
Batch size 32
Input size 224
Select CrossEntropyLoss criterion
Enabling mixed precision for training...
Current learning rate: 0.001
Epoch 1 - avg_train_loss: 0.9431             avg_val_loss: 0.6512  time: 77s
Epoch 1 - Accuracy: 0.760272031737036 - F1-score 0.75086619611335
Epoch 1 - Save Best Accuracy: 0.7603 -                 Save Best F1-score: 0.7509 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 2 - avg_train_loss: 0.6132             avg_val_loss: 0.5299  time: 76s
Epoch 2 - Accuracy: 0.8092944176820629 - F1-score 0.8001183202281793
Epoch 2 - Save Best Accuracy: 0.8093 -                 Save Best F1-score: 0.8001 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 3 - avg_train_loss: 0.5040             avg_val_loss: 0.4938  time: 77s
Epoch 3 - Accuracy: 0.821762538962879 - F1-score 0.8158852233525766
Epoch 3 - Save Best Accuracy: 0.8218 -                 Save Best F1-score: 0.8159 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 4 - avg_train_loss: 0.4366             avg_val_loss: 0.4709  time: 77s
Epoch 4 - Accuracy: 0.8291300651742703 - F1-score 0.8266593682793337
Epoch 4 - Save Best Accuracy: 0.8291 -                 Save Best F1-score: 0.8267 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 5 - avg_train_loss: 0.3970             avg_val_loss: 0.4613  time: 77s
Epoch 5 - Accuracy: 0.8325304618872201 - F1-score 0.829752612380217
Epoch 5 - Save Best Accuracy: 0.8325 -                 Save Best F1-score: 0.8298 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 6 - avg_train_loss: 0.3484             avg_val_loss: 0.4601  time: 77s
Epoch 6 - Accuracy: 0.8339472938509492 - F1-score 0.829485505122573
Number of bad epochs 1
Current learning rate: 0.001
Epoch 7 - avg_train_loss: 0.3133             avg_val_loss: 0.4693  time: 77s
Epoch 7 - Accuracy: 0.8299801643525078 - F1-score 0.8304080397512008
Number of bad epochs 2
Current learning rate: 0.001
Epoch 8 - avg_train_loss: 0.2860             avg_val_loss: 0.4865  time: 77s
Epoch 8 - Accuracy: 0.8342306602436951 - F1-score 0.8341195323473716
Epoch 8 - Save Best Accuracy: 0.8342 -                 Save Best F1-score: 0.8341 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 9 - avg_train_loss: 0.2629             avg_val_loss: 0.4814  time: 76s
Epoch 9 - Accuracy: 0.8401813544913573 - F1-score 0.839317507323863
Epoch 9 - Save Best Accuracy: 0.8402 -                 Save Best F1-score: 0.8393 Model
Number of bad epochs 0
Current learning rate: 0.001
Epoch 10 - avg_train_loss: 0.2405             avg_val_loss: 0.4953  time: 77s
Epoch 10 - Accuracy: 0.8347973930291868 - F1-score 0.8341269185949087
Number of bad epochs 1
Current learning rate: 0.001
Epoch 11 - avg_train_loss: 0.2171             avg_val_loss: 0.5514  time: 77s
Epoch 11 - Accuracy: 0.8353641258146783 - F1-score 0.8335045762643916
Number of bad epochs 2
Current learning rate: 0.001
Epoch 12 - avg_train_loss: 0.1970             avg_val_loss: 0.5264  time: 77s
Epoch 12 - Accuracy: 0.8356474922074242 - F1-score 0.8359990700802761
Number of bad epochs 3
Current learning rate: 0.001
Epoch 13 - avg_train_loss: 0.1892             avg_val_loss: 0.5816  time: 77s
Epoch 13 - Accuracy: 0.8325304618872201 - F1-score 0.831117205233171
Number of bad epochs 4
Current learning rate: 0.001
Epoch 14 - avg_train_loss: 0.1784             avg_val_loss: 0.5483  time: 77s
Epoch 14 - Accuracy: 0.8339472938509492 - F1-score 0.8342079089333668
Number of bad epochs 5
Current learning rate: 0.001
Epoch 15 - avg_train_loss: 0.1602             avg_val_loss: 0.5694  time: 77s
Epoch 15 - Accuracy: 0.8350807594219326 - F1-score 0.8330704075115921
Number of bad epochs 6
Current learning rate: 0.001
Epoch 16 - avg_train_loss: 0.1556             avg_val_loss: 0.5753  time: 76s
Epoch 16 - Accuracy: 0.83593085860017 - F1-score 0.8351305439289598
Number of bad epochs 7
Current learning rate: 0.001
Epoch 17 - avg_train_loss: 0.1425             avg_val_loss: 0.5887  time: 76s
Epoch 17 - Accuracy: 0.8345140266364409 - F1-score 0.8337137516447103
Number of bad epochs 8
Current learning rate: 0.001
Epoch 18 - avg_train_loss: 0.1352             avg_val_loss: 0.6028  time: 76s
Epoch 18 - Accuracy: 0.8356474922074242 - F1-score 0.8356405115201069
Number of bad epochs 9
Current learning rate: 0.001
Epoch 19 - avg_train_loss: 0.1299             avg_val_loss: 0.6066  time: 77s
Epoch 19 - Accuracy: 0.8387645225276282 - F1-score 0.8381772102031679
Number of bad epochs 10
Current learning rate: 0.001
Epoch 20 - avg_train_loss: 0.1242             avg_val_loss: 0.6075  time: 77s
Epoch 20 - Accuracy: 0.8362142249929159 - F1-score 0.8357369756468608
Number of bad epochs 11
Stop the training, since the score has not improved for 10 epochs!
AFTER TRAINING: Epoch 9: Best Accuracy: 0.8402 -                 Best F1-score: 0.8393
